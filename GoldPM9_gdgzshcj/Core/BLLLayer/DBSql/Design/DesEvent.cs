#region <auto-generated>
//此代码由T4模板自动生成 
//生成时间 2016-07-19 21:50:51
#endregion
using System;
using System.Collections.Generic;
using System.Linq;
using System.Linq.Expressions;
using System.Text;
using Common.Data;
using Common.Data.Extenstions;
using DAL;
namespace DBSql.Design
{
    public class DesEvent : EFRepository<DataModel.Models.DesEvent>
    {

        public void UpdateDesEventList(int[] ids, DataModel.EmpSession userInfo)
        {
            if (ids.Length == 0)
            {
                return;
            }
            string idSet = string.Join(",", ids);
            if (string.IsNullOrEmpty(idSet))
            {
                return;
            }
            var sbSQL = new StringBuilder();
            sbSQL.Append(string.Format("Update DesEvent set DeleterEmpId={0},DeleterEmpName='{1}',DeletionTime='{2}' WHERE ID IN ({3})", userInfo.EmpID, userInfo.EmpName, DateTime.Now, idSet));
            sbSQL.Append(string.Format(";Update OaMessRead set MessReadIsDeleted=1  WHERE ID IN (select  Id from  OaMess WHERE MessRefTable='{0}' and  MessRefID IN ({1}))", "DesEvent", idSet));
            sbSQL.Append(string.Format(";Update OaMess set MessIsDeleted=1 WHERE MessRefTable='{0}' and  MessRefID IN ({1})", "DesEvent", idSet));


            DAL.DBExecute.ExecuteNonQuery(sbSQL.ToString());
        }

    }
}
