#pragma warning disable 1591
//------------------------------------------------------------------------------
// <auto-generated>
//     此代码由工具生成。
//     运行时版本:4.0.30319.42000
//
//     对此文件的更改可能会导致不正确的行为，并且如果
//     重新生成代码，这些更改将会丢失。
// </auto-generated>
//------------------------------------------------------------------------------

namespace ASP
{
    using System;
    using System.Collections.Generic;
    using System.IO;
    using System.Linq;
    using System.Net;
    using System.Text;
    using System.Web;
    using System.Web.Helpers;
    using System.Web.Mvc;
    using System.Web.Mvc.Ajax;
    using System.Web.Mvc.Html;
    using System.Web.Routing;
    using System.Web.Security;
    using System.Web.UI;
    using System.Web.WebPages;
    
    [System.CodeDom.Compiler.GeneratedCodeAttribute("RazorGenerator", "2.0.0.0")]
    [System.Web.WebPages.PageVirtualPathAttribute("~/Views/PubFlow/Display.cshtml")]
    public partial class _Views_PubFlow_Display_cshtml : System.Web.Mvc.WebViewPage<dynamic>
    {
        public _Views_PubFlow_Display_cshtml()
        {
        }
        public override void Execute()
        {
            
            #line 1 "..\..\Views\PubFlow\Display.cshtml"
  
    var flag = Guid.NewGuid().ToString("N");

            
            #line default
            #line hidden
WriteLiteral("\r\n<div");

WriteAttribute("id", Tuple.Create(" id=\"", 57), Tuple.Create("\"", 73)
, Tuple.Create(Tuple.Create("", 62), Tuple.Create("flow", 62), true)
            
            #line 4 "..\..\Views\PubFlow\Display.cshtml"
, Tuple.Create(Tuple.Create("", 66), Tuple.Create<System.Object, System.Int32>(flag
            
            #line default
            #line hidden
, 66), false)
);

WriteLiteral(">\r\n    <table");

WriteLiteral(" class=\"table table-bordered\"");

WriteLiteral(">\r\n        <tr>\r\n            <th>意见：</th>\r\n            <td>\r\n                <tex" +
"tarea");

WriteLiteral(" flowflag=\"_flow_note\"");

WriteLiteral(" name=\"_flow_note\"");

WriteLiteral(" style=\"width:99%;height:120px;\"");

WriteLiteral(" validType=\"length[0,200]\"");

WriteLiteral(" />\r\n            </td>\r\n        </tr>\r\n        <tr>\r\n            <th");

WriteLiteral(" style=\"width:20%\"");

WriteLiteral(">下一步：</th>\r\n            <td");

WriteLiteral(" flowflag=\"_td_step\"");

WriteLiteral(" style=\"width:85%\"");

WriteLiteral(">\r\n                <input");

WriteLiteral(" flowflag=\"_flow_step\"");

WriteLiteral(" name=\"_flow_step\"");

WriteLiteral(" style=\"width:60%\"");

WriteLiteral(" />\r\n            </td>\r\n        </tr>\r\n        <tr>\r\n            <th>人员：</th>\r\n  " +
"          <td");

WriteLiteral(" flowflag=\"_td_user\"");

WriteLiteral(" style=\"height:45px\"");

WriteLiteral(">\r\n                <div");

WriteLiteral(" flag=\"0\"");

WriteLiteral(">\r\n                    <input");

WriteLiteral(" flowflag=\"_flow_user\"");

WriteLiteral(" name=\"_flow_user\"");

WriteLiteral(" style=\"width:60%;\"");

WriteLiteral(" />\r\n                </div>\r\n            </td>\r\n        </tr>\r\n    </table>\r\n</di" +
"v>\r\n<script");

WriteLiteral(" type=\"text/javascript\"");

WriteLiteral(">\r\n    var _params = {\r\n        refID: \"");

            
            #line 30 "..\..\Views\PubFlow\Display.cshtml"
            Write(Request.QueryString["refID"]);

            
            #line default
            #line hidden
WriteLiteral("\",\r\n        refTable: JQ.Flow.htmlDecode(\"");

            
            #line 31 "..\..\Views\PubFlow\Display.cshtml"
                                  Write(HttpUtility.UrlDecode((Request.QueryString["refTable"]??"")));

            
            #line default
            #line hidden
WriteLiteral("\"),\r\n        flowNodeID: \"");

            
            #line 32 "..\..\Views\PubFlow\Display.cshtml"
                 Write(Request.QueryString["flowNodeID"]);

            
            #line default
            #line hidden
WriteLiteral("\",\r\n        flowMultiSignID: \"");

            
            #line 33 "..\..\Views\PubFlow\Display.cshtml"
                      Write(Request.QueryString["flowMultiSignID"]);

            
            #line default
            #line hidden
WriteLiteral("\",\r\n        instance: JQ.Flow.htmlDecode(\"");

            
            #line 34 "..\..\Views\PubFlow\Display.cshtml"
                                  Write(HttpUtility.UrlDecode((Request.QueryString["instance"] ??"")));

            
            #line default
            #line hidden
WriteLiteral("\"),\r\n        action: JQ.Flow.htmlDecode(\"");

            
            #line 35 "..\..\Views\PubFlow\Display.cshtml"
                                Write(HttpUtility.UrlDecode((Request.QueryString["action"] ??"")));

            
            #line default
            #line hidden
WriteLiteral("\"),\r\n        service: JQ.Flow.htmlDecode(\"");

            
            #line 36 "..\..\Views\PubFlow\Display.cshtml"
                                 Write(HttpUtility.UrlDecode((Request.QueryString["service"] ??"")));

            
            #line default
            #line hidden
WriteLiteral("\"),\r\n        guid: \"");

            
            #line 37 "..\..\Views\PubFlow\Display.cshtml"
           Write(Request.QueryString["guid"]);

            
            #line default
            #line hidden
WriteLiteral("\",\r\n        isquote: \"");

            
            #line 38 "..\..\Views\PubFlow\Display.cshtml"
              Write(Request.QueryString["isquote"]);

            
            #line default
            #line hidden
WriteLiteral("\",\r\n        isLastStep: false\r\n    };\r\n    $(function () {\r\n        var $div = $(" +
"\"#flow");

            
            #line 42 "..\..\Views\PubFlow\Display.cshtml"
                       Write(flag);

            
            #line default
            #line hidden
WriteLiteral(@""");
        var $_flow_note = $div.find(""[flowflag='_flow_note']"");
        var $_flow_step = $div.find(""[flowflag='_flow_step']"");
        var $_td_step = $div.find(""[flowflag='_td_step']"");
        var $_td_user = $div.find(""[flowflag='_td_user']"");
        var $_flow_user = $div.find(""[flowflag='_flow_user']"");
        var options = {
            formid: ""display"",
            buttonTypes: ['close'],
            succesCollBack: function (data) {
                JQ.dialog.dialogClose();
            }
        }
        if (_params.action == ""next"") {
            options.beforeButtons = [
                { icon: ""fa-toggle-right"", id: ""btnSubmit");

            
            #line 57 "..\..\Views\PubFlow\Display.cshtml"
                                                     Write(flag);

            
            #line default
            #line hidden
WriteLiteral("\", text: \"审批提交\", disabled: true }\r\n            ];\r\n        }\r\n        else if (_p" +
"arams.action == \"back\") {\r\n            options.beforeButtons = [\r\n              " +
"  { icon: \"fa-toggle-left\", id: \"btnBack");

            
            #line 62 "..\..\Views\PubFlow\Display.cshtml"
                                                  Write(flag);

            
            #line default
            #line hidden
WriteLiteral("\", text: \"审批退回\", disabled: true }\r\n            ];\r\n        }\r\n        else if (_p" +
"arams.action == \"transfer\") {\r\n            options.beforeButtons = [\r\n          " +
"      { icon: \"fa-street-view\", id: \"btnTransfter");

            
            #line 67 "..\..\Views\PubFlow\Display.cshtml"
                                                       Write(flag);

            
            #line default
            #line hidden
WriteLiteral("\", text: \"工作移交\", disabled: true }\r\n            ];\r\n        }\r\n        else if (_p" +
"arams.action == \"finish\") {\r\n            options.beforeButtons = [{\r\n           " +
"     icon: \"fa fa-check-circle\", id: \"btnFinish");

            
            #line 72 "..\..\Views\PubFlow\Display.cshtml"
                                                      Write(flag);

            
            #line default
            #line hidden
WriteLiteral("\", text: \"直接完成\", onClick: function () {\r\n                    if (!$_flow_note.tex" +
"tbox(\"isValid\")) {\r\n                        $_flow_note.focus();\r\n              " +
"          return;\r\n                    }\r\n                    JQ.dialog.confirm(" +
"\"确定要直接完成吗？\", function () {\r\n                        window[_params.instance].sub" +
"mit({\r\n                            action: _params.action,\r\n                    " +
"        note: $_flow_note.textbox(\"getText\")\r\n                        });\r\n     " +
"               });\r\n                }\r\n            }];\r\n            $_td_step.ht" +
"ml(\"直接完成\");\r\n            $_td_user.html(\"不需要选择\");\r\n            initNoteBox(false" +
");\r\n        }\r\n        else if (_params.action == \"reject\") {\r\n            optio" +
"ns.beforeButtons = [{\r\n                icon: \"fa fa-times-circle\", id: \"btnRejec" +
"t\", text: \"直接否决\", onClick: function () {\r\n                    if (!$_flow_note.t" +
"extbox(\"isValid\")) {\r\n                        $_flow_note.textbox(\"textbox\").foc" +
"us();\r\n                        return;\r\n                    }\r\n                 " +
"   JQ.dialog.confirm(\"确定要直接否决吗？\", function () {\r\n                        window[" +
"_params.instance].submit({\r\n                            action: _params.action,\r" +
"\n                            note: $_flow_note.textbox(\"getText\")\r\n             " +
"           });\r\n                    });\r\n                }\r\n            }];\r\n   " +
"         $_td_step.html(\"直接否决\");\r\n            $_td_user.html(\"不需要选择\");\r\n        " +
"    initNoteBox(false);\r\n        }\r\n        else if (_params.action == \"undo\") {" +
"\r\n            options.beforeButtons = [\r\n                { icon: \"fa-undo\", id: " +
"\"btnUndo");

            
            #line 110 "..\..\Views\PubFlow\Display.cshtml"
                                           Write(flag);

            
            #line default
            #line hidden
WriteLiteral(@""", text: ""撤销审批"", disabled: true }
            ];
        }
        JQ.form.submitInit(options);
        if (_params.action == ""next"" || _params.action == ""back"" || _params.action == ""transfer"" || _params.action == ""undo"") {
            // debugger;
            getOptions();
        }
        //获取加载选项
        function getOptions() {
            var postOptions = { _refID: _params.refID, _refTable: _params.refTable, _flowNodeID: _params.flowNodeID, _action: ""load_"" + _params.action, _flowMultiSignID: _params.flowMultiSignID };
            if (_params.guid) {
                postOptions._guid = _params.guid;
            }
            debugger;
            $.ajax({
                url: _params.service,
                type: ""POST"",
                data: postOptions,
                success: function (result) {
                    if (window[_params.instance].filterSteps) {
                        window[_params.instance].filterSteps(result.NextSteps, _params.action);
                    }
                    debugger
                    loadResult(result);
                    if (!$_flow_note.textbox(""isValid"")) {
                        $_flow_note.textbox(""textbox"").focus();
                        return;
                    }
                    if (_params.action == ""next"") {
                        $(""#btnSubmit");

            
            #line 140 "..\..\Views\PubFlow\Display.cshtml"
                                 Write(flag);

            
            #line default
            #line hidden
WriteLiteral(@""").linkbutton(""enable"").click(function () {
                            var options = {
                                action: _params.action
                            };
                            if (!_params.isLastStep) {
                                options.nextNodeID = $_flow_step.combobox(""getValue"");
                                if ($div.find(""[flowflag='n"" + options.nextNodeID + ""']"").length > 0) {
                                    options.nextEmpIDs = $(""#hidEmp"" + options.nextNodeID).val();
                                }
                                else {
                                    options.nextEmpIDs = $_flow_user.combobox(""getValue"");
                                }
                                if (options.nextEmpIDs == """") {
                                    JQ.dialog.question(""请选择需要提交的人员"");
                                    return;
                                }
                            }
                            JQ.dialog.confirm(""确定要审批提交"" + (_params.isLastStep ? ""（流程将结束）"" : """") + ""吗？"", function () {
                                options.note = $_flow_note.textbox(""getText"");
                                window[_params.instance].submit(options);
                            });
                        });
                    }
                    else if (_params.action == ""back"") {
                        $(""#btnBack");

            
            #line 164 "..\..\Views\PubFlow\Display.cshtml"
                               Write(flag);

            
            #line default
            #line hidden
WriteLiteral(@""").linkbutton(""enable"").click(function () {
                            var options = {
                                action: _params.action
                            };
                            if (!_params.isLastStep) {
                                options.nextNodeID = $_flow_step.combobox(""getValue"");
                                var signs = $_td_user.find(""div[flowflag='n"" + options.nextNodeID + ""']"");
                                if (signs.length > 0) {
                                    options.nextEmpIDs = signs.find(""#hidEmp"" + options.nextNodeID).val();
                                }
                                else {
                                    options.nextEmpIDs = $_flow_user.combobox(""getValue"");
                                }
                                if (options.nextEmpIDs == """") {
                                    JQ.dialog.question(""请选择需要退回的人员"");
                                    return;
                                }
                            }
                            JQ.dialog.confirm(""确定要审批退回吗？"", function () {
                                options.note = $_flow_note.textbox(""getText"");
                                window[_params.instance].submit(options);
                            });
                        });
                    }
                    else if (_params.action == ""undo"") {
                        $(""#btnUndo");

            
            #line 189 "..\..\Views\PubFlow\Display.cshtml"
                               Write(flag);

            
            #line default
            #line hidden
WriteLiteral("\").linkbutton(\"enable\").click(function () {\r\n                            var opti" +
"ons = {\r\n                                action: _params.action\r\n               " +
"             };\r\n                            options.nextNodeID = $_flow_step.co" +
"mbobox(\"getValue\");\r\n                            var signs = $_td_user.find(\"div" +
"[flowflag=\'n\" + options.nextNodeID + \"\']\");\r\n                            if (sig" +
"ns.length > 0) {\r\n                                options.nextEmpIDs = signs.fin" +
"d(\"#hidEmp\" + options.nextNodeID).val();\r\n                            }\r\n       " +
"                     else {\r\n                                options.nextEmpIDs " +
"= $_flow_user.combobox(\"getValue\");\r\n                            }\r\n            " +
"                if (options.nextEmpIDs == \"\") {\r\n                               " +
" JQ.dialog.question(\"请选择需要撤销的步骤或人员\");\r\n                                return;\r\n" +
"                            }\r\n                            JQ.dialog.confirm(\"确定" +
"要撤销审批吗？\", function () {\r\n                                options.note = $_flow_n" +
"ote.textbox(\"getText\");\r\n                                window[_params.instance" +
"].submit(options);\r\n                            });\r\n                        });" +
"\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n      " +
"  function initNoteBox(isRequired, defaultNote) {\r\n            $_flow_note.textb" +
"ox({\r\n                multiline: true,\r\n                prompt: \"请输入意见\",\r\n      " +
"          required: isRequired,\r\n                validType: [\"length[0,500]\"]\r\n " +
"           });\r\n            if (window[_params.instance].getNote) {\r\n           " +
"     defaultNote = window[_params.instance].getNote() || defaultNote;\r\n         " +
"   }\r\n            $_flow_note.textbox(\"setText\", defaultNote || \"\");\r\n        }\r" +
"\n\r\n        function loadResult(result) {\r\n            if (window[_params.instanc" +
"e].getStepUsers) {\r\n                for (var i = 0; i < result.NextSteps.length;" +
" i++) {\r\n                    var stepResult = window[_params.instance].getStepUs" +
"ers(result.NextSteps[i], _params.action);\r\n                    if (stepResult) {" +
"\r\n                        if (\"choosedUserNames\" in stepResult) {\r\n             " +
"               result.NextSteps[i].ChoosedUserNames = stepResult.choosedUserName" +
"s;\r\n                        }\r\n                        if (\"choosedUsers\" in ste" +
"pResult) {\r\n                            result.NextSteps[i].ChoosedUsers = stepR" +
"esult.choosedUsers;\r\n                        }\r\n                        if (\"def" +
"aultChoosedUser\" in stepResult) {\r\n                            result.NextSteps[" +
"i].DefaultChoosedUser = stepResult.defaultChoosedUser;\r\n                        " +
"}\r\n                        if (\"users\" in stepResult) {\r\n                       " +
"     result.NextSteps[i].Users = [];\r\n                            for (var j = 0" +
"; j < stepResult.users.length; j++) {\r\n                                result.Ne" +
"xtSteps[i].Users.push({ ID: stepResult.users[j].id, Name: stepResult.users[j].na" +
"me });\r\n                            }\r\n                        }\r\n              " +
"      }\r\n                }\r\n            }\r\n            initNoteBox(result.IsNote" +
"Required, result.DefaultNote);\r\n            if (_params.action == \"transfer\") {\r" +
"\n                if (result.NextSteps.length > 0) {\r\n                    $_td_st" +
"ep.html(result.NextSteps[0].NodeName);\r\n                    if (result.NextSteps" +
"[0].Users.length == 0) {\r\n                        $_td_user.html(\"无可移交人员\");\r\n   " +
"                     return;\r\n                    }\r\n                    loadUse" +
"rs(result.NextSteps[0]);\r\n                    $(\"#btnTransfter");

            
            #line 260 "..\..\Views\PubFlow\Display.cshtml"
                                Write(flag);

            
            #line default
            #line hidden
WriteLiteral("\").linkbutton(\"enable\").click(function () {\r\n                        JQ.dialog.co" +
"nfirm(\"确定要工作移交吗？\", function () {\r\n                            window[_params.ins" +
"tance].submit({\r\n                                action: _params.action,\r\n      " +
"                          nextEmpIDs: $_flow_user.combobox(\"getValue\"),\r\n       " +
"                         note: $_flow_note.textbox(\"getText\")\r\n                 " +
"           });\r\n                        });\r\n                    });\r\n          " +
"      }\r\n                else {\r\n                    $_td_step.html(\"\");\r\n      " +
"              $_td_user.html(\"无可移交人员\");\r\n                }\r\n                retu" +
"rn;\r\n            }\r\n            if (result.IsLastStep === true) {\r\n             " +
"   $_td_step.html(\"流程结束\");\r\n                $_td_user.html(\"不需要选择\");\r\n          " +
"      _params.isLastStep = true;\r\n            }\r\n            else {\r\n           " +
"     $_flow_step.combobox({\r\n                    editable: false,\r\n             " +
"       panelHeight: \"auto\",\r\n                    textField: \"NodeName\",\r\n       " +
"             valueField: \"NodeID\",\r\n                    data: result.NextSteps,\r" +
"\n                    onSelect: function (item) {\r\n                        loadUs" +
"ers(item);\r\n                    }\r\n                });\r\n                var defa" +
"ultStep = null;\r\n                debugger;\r\n                if (result.DefaultCh" +
"oosedStep) {\r\n                    var isExists = false;\r\n                    for" +
" (var i = 0; i < result.NextSteps.length; i++) {\r\n                        if (re" +
"sult.NextSteps[i].NodeID == result.DefaultChoosedStep) {\r\n                      " +
"      defaultStep = result.NextSteps[i];\r\n                            isExists =" +
" true;\r\n                            break;\r\n                        }\r\n         " +
"           }\r\n                    if (!isExists) {\r\n                        if (" +
"result.NextSteps.length > 0) {\r\n                            defaultStep = result" +
".NextSteps[0];\r\n                        }\r\n                    }\r\n              " +
"  }\r\n                else if (result.NextSteps.length > 0) {\r\n\r\n                " +
"    defaultStep = result.NextSteps[0];\r\n                }\r\n                if (d" +
"efaultStep) {\r\n                    $_flow_step.combobox(\"setValue\", defaultStep." +
"NodeID.toString());\r\n                    loadUsers(defaultStep);\r\n              " +
"  }\r\n            }\r\n        }\r\n\r\n        function loadUsers(item) {\r\n           " +
" if (!item) {\r\n                return;\r\n            }\r\n            if (item.Node" +
"Type == -1) {\r\n                //会签\r\n                loadMultiUsers(item);\r\n    " +
"        }\r\n            else {\r\n                loadComboboxUsers(item);\r\n       " +
"     }\r\n        }\r\n\r\n        function loadComboboxUsers(item) {\r\n            $_t" +
"d_user.find(\"div[flag!=\'0\']\").hide();\r\n            if (!item.Users || item.Users" +
".length == 0) {\r\n                return;\r\n            }\r\n            $_td_user.f" +
"ind(\"div[flag=\'0\']\").show();\r\n            $_flow_user.combobox({\r\n              " +
"  editable: true,\r\n                panelHeight: (item.Users.length < 8 ? \"auto\" " +
": 200),\r\n                textField: \"Name\",\r\n                valueField: \"ID\",\r\n" +
"                data: item.Users,\r\n                onSelect: function (userData)" +
" {\r\n                    item.DefaultChoosedUser = userData.ID;\r\n                " +
"},\r\n                onHidePanel: function () {\r\n                    comBoxHidePa" +
"nel(this);\r\n                }\r\n            });\r\n            if (item.DefaultChoo" +
"sedUser) {\r\n                //选中默认人员\r\n                $_flow_user.combobox(\"setV" +
"alue\", item.DefaultChoosedUser);\r\n            }\r\n            else if (item.Users" +
".length > 0) {\r\n                //选中第一个人员\r\n                $_flow_user.combobox(" +
"\"setValue\", item.Users[0].ID);\r\n            }\r\n        }\r\n\r\n        function loa" +
"dMultiUsers(item) {\r\n            $_td_user.find(\"div[flag!=\'\" + item.NodeID + \"\'" +
"]\").hide();\r\n            //$(\"#_td_user>div[flag!=\'\" + item.NodeID + \"\']\").hide(" +
");\r\n            var $div = $_td_user.find(\"div[flowflag=\'n\" + item.NodeID + \"\']\"" +
");\r\n            //document.getElementById(\"_$_divNode_\" + item.NodeID);\r\n       " +
"     if ($div.length == 0) {\r\n                var div = document.createElement(\"" +
"div\");\r\n                div.setAttribute(\"flowflag\", \"n\" + item.NodeID);\r\n      " +
"          div.setAttribute(\"flag\", item.NodeID);\r\n                $_td_user[0].a" +
"ppendChild(div);\r\n                var hidEmp = document.getElementById(\"hidEmp\" " +
"+ item.NodeID);\r\n                if (hidEmp) {\r\n                    hidEmp.paren" +
"tNode.removeChild(hidEmp);\r\n                }\r\n                hidEmp = document" +
".createElement(\"input\");\r\n                hidEmp.setAttribute(\"id\", \"hidEmp\" + i" +
"tem.NodeID);\r\n                hidEmp.setAttribute(\"type\", \"hidden\");\r\n          " +
"      hidEmp.setAttribute(\"value\", item.ChoosedUsers || \"\");\r\n                di" +
"v.appendChild(hidEmp);\r\n                if (_params.action == \"undo\" && item.Cho" +
"osedUsers) {\r\n                    div.appendChild(document.createTextNode(item.C" +
"hoosedUserNames));\r\n                }\r\n                else {\r\n                 " +
"   var chooseEmp = document.getElementById(\"chooseEmp\" + item.NodeID);\r\n        " +
"            if (chooseEmp) {\r\n                        chooseEmp.parentNode.remov" +
"eChild(chooseEmp);\r\n                    }\r\n                    chooseEmp = docum" +
"ent.createElement(\"input\");\r\n                    chooseEmp.setAttribute(\"id\", \"c" +
"hooseEmp\" + item.NodeID);\r\n                    chooseEmp.setAttribute(\"value\", i" +
"tem.ChoosedUserNames || \"\");\r\n                    div.appendChild(chooseEmp);\r\n " +
"                   JQ.textbox.selEmp({\r\n                        id: \"chooseEmp\" " +
"+ item.NodeID,\r\n                        setID: \"hidEmp\" + item.NodeID,\r\n        " +
"                width: 300\r\n                    });\r\n                }\r\n        " +
"    }\r\n            else {\r\n                $div[0].style.display = \"\";\r\n        " +
"    }\r\n        }\r\n    });\r\n</script>");

        }
    }
}
#pragma warning restore 1591
