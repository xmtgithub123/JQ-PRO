#pragma warning disable 1591
//------------------------------------------------------------------------------
// <auto-generated>
//     此代码由工具生成。
//     运行时版本:4.0.30319.42000
//
//     对此文件的更改可能会导致不正确的行为，并且如果
//     重新生成代码，这些更改将会丢失。
// </auto-generated>
//------------------------------------------------------------------------------

namespace ASP
{
    using System;
    using System.Collections.Generic;
    using System.IO;
    using System.Linq;
    using System.Net;
    using System.Text;
    using System.Web;
    using System.Web.Helpers;
    using System.Web.Mvc;
    using System.Web.Mvc.Ajax;
    using System.Web.Mvc.Html;
    using System.Web.Routing;
    using System.Web.Security;
    using System.Web.UI;
    using System.Web.WebPages;
    
    #line 4 "..\..\Views\DesTask\ProjectProgressList.cshtml"
    using JQ.Web;
    
    #line default
    #line hidden
    
    [System.CodeDom.Compiler.GeneratedCodeAttribute("RazorGenerator", "2.0.0.0")]
    [System.Web.WebPages.PageVirtualPathAttribute("~/Views/DesTask/ProjectProgressList.cshtml")]
    public partial class _Views_DesTask_ProjectProgressList_cshtml : System.Web.Mvc.WebViewPage<dynamic>
    {
        public _Views_DesTask_ProjectProgressList_cshtml()
        {
        }
        public override void Execute()
        {
            
            #line 1 "..\..\Views\DesTask\ProjectProgressList.cshtml"
  
    Layout = "~/Areas/Core/Views/Shared/_Layout.cshtml";

            
            #line default
            #line hidden
WriteLiteral("\r\n");

DefineSection("head", () => {

WriteLiteral("\r\n    <script");

WriteLiteral(" type=\"text/javascript\"");

WriteLiteral(@">
        $(function () {
            JQ.treegrid.treegrid({
                pagination: true,
                JQButtonTypes: ['export', 'moreSearch'],//需要显示的按钮
                JQPrimaryID: 'Id',//主键的字段
                idField: 'Id',
                treeField: 'ProjName',
                JQID: 'ProjectGrid',//数据表格ID
                JQDialogTitle: '信息',//弹出窗体标题
                JQWidth: '1024',//弹出窗体宽
                JQHeight: '100%',//弹出窗体高
                JQLoadingType: 'treegrid',//数据表格类型 [datagrid,treegrid]
                JQExcludeCol: [1, 11, 12, 13],//导出execl排除的列
                singleSelect: true,
                url: '");

            
            #line 21 "..\..\Views\DesTask\ProjectProgressList.cshtml"
                 Write(Url.Action("jsonNew", "Project",new { @area="Project"}));

            
            #line default
            #line hidden
WriteLiteral("?FormMenu=EngineerMain\',//请求的地址\r\n                checkOnSelect: true,//是否包含check\r" +
"\n                singleSelect: false,\r\n                toolbar: \'#ProjectPanel\'," +
"//工具栏的容器ID\r\n                JQMergeCells: { fields: [\'ck\', \'FlowProgress\'], Only" +
": \'ColAttType5\' },\r\n                columns: [[\r\n                  {\r\n          " +
"            field: \'ck\', align: \'center\', checkbox: true, JQIsExclude: true, for" +
"matter: function (value, row) {\r\n                          return \"\"\r\n          " +
"            }\r\n                  },\r\n                  { title: \'ColAttType5\', f" +
"ield: \'ColAttType5\', hidden: true },\r\n\t              { title: \'项目名称\', field: \'Pr" +
"ojName\', width: \"28%\", halign: \'center\', align: \'left\' },\r\n                  { t" +
"itle: \'设总\', field: \'ProjEmpName\', width: \"80\", halign: \'center\', align: \'center\'" +
" },\r\n                  {\r\n                      title: \'项目阶段\', field: \'PhaseName" +
"s\', width: \"15%\", halign: \'center\', align: \'left\', formatter: function (value) {" +
"\r\n                          if (value != \"\") {\r\n                              re" +
"turn value.substring(0, value.length - 1);\r\n                          }\r\n       " +
"               }\r\n                  },\r\n\t\t          { title: \'项目类别\', field: \'Pro" +
"jTypeName\', width: \"80\", halign: \'center\', align: \'center\' },\r\n\t\t          { tit" +
"le: \'建设性质\', field: \'ProjPropertyName\', width: \"80\", halign: \'center\', align: \'ce" +
"nter\' },\r\n\t\t          { title: \'立项时间\', field: \'DateCreate\', width: \"80\", halign:" +
" \'center\', align: \'center\', formatter: JQ.tools.DateTimeFormatterByT },\r\n\t\t     " +
"     { title: \'计划完成时间\', field: \'DatePlanFinish\', width: \"80\", halign: \'center\', " +
"align: \'center\', formatter: JQ.tools.DateTimeFormatterByT },\r\n                  " +
"{\r\n                      field: \'JQFiles\', title: \'附件\', halign: \'center\', align:" +
" \'center\', width: \"40px\", JQIsExclude: true, JQExcludeFlag: \"grid_files\", JQRefT" +
"able: \'Project\', IsShow: \'None\',\r\n                      formatter: function (val" +
"ue, row) {\r\n                          return \"<span id=\\\"grid_files_\" + row.Id +" +
" \"\\\"></span>\"\r\n                      }\r\n                  },\r\n                  " +
"{\r\n                      field: \"FlowProgress\", title: \"流程进度\", halign: \'center\'," +
" align: \"left\", width: \"8%\", formatter: function (value, rowData) {\r\n           " +
"               if (rowData.ParentId != 0) {\r\n\r\n                              ret" +
"urn JQ.Flow.showProgress(\"FlowID\", \"FlowName\", \"FlowStatusID\", \"FlowStatusName\"," +
" \"FlowTurnedEmpIDs\", \"CreatorEmpId\", \"");

            
            #line 56 "..\..\Views\DesTask\ProjectProgressList.cshtml"
                                                                                                                                                   Write(ViewBag.CurrentEmpID);

            
            #line default
            #line hidden
WriteLiteral("\")(value, rowData);\r\n                          }\r\n                      }\r\n      " +
"            },\r\n                  {\r\n                      field: \"opt\", title: " +
"\"查看\", align: \"center\", halign: \"center\", width: \"60px\", formatter: function (val" +
"ue, row, index) {\r\n                          if (row.ParentId == 0) {\r\n         " +
"                     return \"\"\r\n                          }\r\n                   " +
"       else {\r\n                              var _titleName = \"项目进度：[\" + row.Pro" +
"jNumber.escapeHTML() + \"]\" + row.ProjName.escapeHTML();\r\n                       " +
"       return \"<a href=\\\"javascript:void(0);\\\" class=\\\"easyui-linkbutton\\\" data-" +
"options=\\\"plain:true,iconCls:\'fa fa-trash\'\\\" onclick=\\\"openProjectProgressInfo(\'" +
"{0}\', {1}, 0 )\\\">项目进度</a>\".format(_titleName, row.Id);\r\n                        " +
"  }\r\n                      }\r\n                  }\r\n                ]],\r\n        " +
"        onLoadSuccess: function (rowIndex, rowDatas) {\r\n                    var " +
"$rows = $(\"#ProjectGrid\").parent().find(\".datagrid-view2 .datagrid-body tr.datag" +
"rid-row\");\r\n                    if (\"total\" in rowDatas) {\r\n                    " +
"    for (var i = 0; i < rowDatas.rows.length; i++) {\r\n                          " +
"  var gRow = $rows.filter(\"[node-id=\'\" + rowDatas.rows[i].Id + \"\']\");\r\n         " +
"                   gRow.find(\"td[field=\'ck\']\").find(\"input[type=\'checkbox\']\").hi" +
"de()\r\n                        }\r\n                    }\r\n                   \r\n   " +
"                 for (var i = 0; i < rowDatas.length; i++) {\r\n                  " +
"      if (rowDatas[i].FlowID != null) {\r\n                            for (var j " +
"= 0; j < rowDatas.length; j++) {\r\n                                if (rowDatas[j" +
"].FlowID != rowDatas[i].FlowID && rowDatas[j].BridgeGuid == rowDatas[i].BridgeGu" +
"id) {\r\n                                    rowDatas[j]._AllowCheck = rowDatas[i]" +
"._AllowCheck;\r\n                                    rowDatas[j]._EditStatus = row" +
"Datas[i]._EditStatus;\r\n                                }\r\n                      " +
"      }\r\n                        }\r\n                    }\r\n                    v" +
"ar flag, start, amount = 0;\r\n                    for (var i = 0; i < rowDatas.le" +
"ngth; i++) {\r\n                        //验证checkbox\r\n                        if (" +
"rowDatas[i]._AllowCheck === false) {\r\n                            $rows.filter(\"" +
"[node-id=\'\" + rowDatas[i].Id + \"\']\").find(\"td[field=\'ck\'] :checkbox\").prop(\"disa" +
"bled\", \"disabled\");\r\n                        }\r\n                        if (!fla" +
"g || rowDatas[i].BridgeGuid != flag) {\r\n                            if (amount >" +
" 1) {\r\n                                //合并\r\n                                var" +
" gRow = $rows.filter(\"[node-id=\'\" + start.Id + \"\']\");\r\n                         " +
"       if (gRow.length > 0) {\r\n                                    gRow.find(\"td" +
"[field=\'FlowProgress\'],td[field=\'JQFiles\'],td[field=\'ck\']\").prop(\"rowSpan\", amou" +
"nt);\r\n                                    for (var j = 0; j < amount - 1; j++) {" +
"\r\n                                        gRow = gRow.next();\r\n                 " +
"                       gRow.find(\"td[field=\'FlowProgress\'],td[field=\'JQFiles\'],t" +
"d[field=\'ck\']\").remove();\r\n                                    }\r\n              " +
"                  }\r\n                            }\r\n                            " +
"flag = rowDatas[i].BridgeGuid;\r\n                            start = rowDatas[i];" +
"\r\n                            amount = 1;\r\n                        }\r\n          " +
"              else {\r\n                            amount++;\r\n                   " +
"     }\r\n                    }\r\n                    if (start && amount > 1) {\r\n " +
"                       var gRow = $rows.filter(\"[node-id=\'\" + start.Id + \"\']\");\r" +
"\n                        if (gRow.length > 0) {\r\n                            gRo" +
"w.find(\"td[field=\'FlowProgress\'],td[field=\'JQFiles\'],td[field=\'ck\']\").prop(\"rowS" +
"pan\", amount);\r\n                            for (var j = 0; j < amount - 1; j++)" +
" {\r\n                                gRow = gRow.next();\r\n                       " +
"         gRow.find(\"td[field=\'FlowProgress\'],td[field=\'JQFiles\'],td[field=\'ck\']\"" +
").remove();\r\n                            }\r\n                        }\r\n         " +
"           }\r\n                    $(\"div.datagrid-header-check input[type=\'check" +
"box\']\").attr(\"style\", \"display:none\");\r\n\r\n                    if (rowDatas.total" +
") {\r\n                        $.each(rowDatas.rows, function (index, item) {\r\n   " +
"                         //$(\"input[type=\'checkbox\']\")[index + 2].style.display " +
"= \"none\";\r\n                            var number = item.row_number;\r\n          " +
"                  $(\"tr[node-id=\'\" + item.Id + \"\']\").find(\"div.datagrid-cell-row" +
"number\").text(number);\r\n                        });\r\n                    } else " +
"{\r\n                        var gridRoots = $(\"#ProjectGrid\").treegrid(\"getRoots\"" +
");\r\n                        var First = 0;\r\n                        $.each(gridR" +
"oots, function (i, n) {\r\n                            var num = n.row_number;\r\n  " +
"                          var rowChildren = $(\"#ProjectGrid\").treegrid(\"getChild" +
"ren\", n.Id);\r\n                            if (rowChildren.length > 0) {\r\n       " +
"                         First += rowChildren.length;\r\n                         " +
"       $(\"tr[node-id=\'\" + n.Id + \"\']\").find(\"div.datagrid-cell-rownumber\").text(" +
"num);\r\n\r\n                                $.each(rowChildren, function (y, k) {\r\n" +
"                                    var tNum = y + num + 1;\r\n                   " +
"                 //$(\"tr[node-id=\'\" + k.Id + \"\']\").find(\"div.datagrid-cell-rownu" +
"mber\").text(num + \'-\' + (y + 1));\r\n                                    $(\"tr[nod" +
"e-id=\'\" + k.Id + \"\']\").find(\"div.datagrid-cell-rownumber\").text(\"\");\r\n          " +
"                      })\r\n                            }\r\n                       " +
"     else {\r\n                                var RowNum = num + First;\r\n        " +
"                        $(\"tr[node-id=\'\" + n.Id + \"\']\").find(\"div.datagrid-cell-" +
"rownumber\").text(num);\r\n                            }\r\n                        }" +
");\r\n                    }\r\n                },\r\n                onBeforeCheck: fu" +
"nction (rowIndex, rowData) {\r\n                    if (rowIndex.ParentId == 0) {\r" +
"\n                        return false;\r\n                    }\r\n                 " +
"   else {\r\n                        return rowIndex._AllowCheck;\r\n               " +
"     }\r\n                },\r\n                onClickRow: function (rowData) {\r\n  " +
"                  if (typeof (rowData._AllowCheck) != \'undefined\') {\r\n          " +
"              if (!rowData._AllowCheck) {\r\n                            $(this).t" +
"reegrid(\'unselect\', rowData.Id);\r\n                        }\r\n\r\n                 " +
"   }\r\n                    else {\r\n                        $(this).treegrid(\'unse" +
"lect\', rowData.Id);\r\n                    }\r\n                },\r\n                " +
"onBeforeLoad: function (row, param) {\r\n                    debugger;\r\n          " +
"          if ($(\"#category\").val() == \"0\") {\r\n                        $(\"#Projec" +
"tGrid\").treegrid(\'options\').url = \'");

            
            #line 180 "..\..\Views\DesTask\ProjectProgressList.cshtml"
                                                                Write(Url.Action("jsonNew", "Project",new { @area="Project"}));

            
            #line default
            #line hidden
WriteLiteral(@"?CompanyType=' + row.CompanyType + '&category=0&FormMenu=EngineerMain';
                    }
                    $(""#category"").val(""0"");
                },
                onBeforeExpand: function (row) {
                    debugger
                    $(""#category"").val(""1"");
                    $(this).treegrid('options').url = '");

            
            #line 187 "..\..\Views\DesTask\ProjectProgressList.cshtml"
                                                  Write(Url.Action("jsonNew", "Project",new { @area="Project"}));

            
            #line default
            #line hidden
WriteLiteral(@"?CompanyType=' + row.CompanyType + '&category=1&FormMenu=EngineerMain';
                }
            });
            $(""#JQSearch"").textbox({
                buttonText: '筛选',
                buttonIcon: 'fa fa-search',
                height: 25,
                prompt: '项目编号,项目名称',
                //queryOptions: { 'Key': 'ProjNumber', 'Contract': 'like' },
                onClickButton: function () {
                    JQ.datagrid.searchGrid(
                        {
                            dgID: 'ProjectGrid',
                            loadingType: 'treegrid',
                            queryParams: null
                        });
                }
            });


        });


        function openProjectProgressInfo(title, projId, taskGroupId) {
            var url = '");

            
            #line 211 "..\..\Views\DesTask\ProjectProgressList.cshtml"
                  Write(Url.Action("ProjectProgressInfo", "DesTask", new { @area = "Design" }));

            
            #line default
            #line hidden
WriteLiteral("?projID=\' + projId + \'&taskGroupId=\' + taskGroupId\r\n            JQ.dialog.dialogI" +
"frame({\r\n                title: title,\r\n                url: url,\r\n             " +
"   width: 1200,\r\n                height: 800\r\n            });\r\n        }\r\n    </" +
"script>\r\n");

WriteLiteral("    ");

            
            #line 220 "..\..\Views\DesTask\ProjectProgressList.cshtml"
Write(RenderPage("~/Areas/Core/Views/Shared/_Init.cshtml"));

            
            #line default
            #line hidden
WriteLiteral("\r\n");

});

WriteLiteral("\r\n");

DefineSection("Body_Content", () => {

WriteLiteral("\r\n    <table");

WriteLiteral(" id=\"ProjectGrid\"");

WriteLiteral("></table>\r\n    <div");

WriteLiteral(" id=\"ProjectPanel\"");

WriteLiteral(" JQPanel=\"searchPanel\"");

WriteLiteral(" style=\"padding:5px;height:auto;\"");

WriteLiteral(">\r\n        <span");

WriteLiteral(" JQPanel=\"toolbarPanel\"");

WriteLiteral(">\r\n\r\n        </span>\r\n\r\n        <input");

WriteLiteral(" id=\"JQSearch\"");

WriteLiteral(" style=\"width:250px;\"");

WriteLiteral(" JQWhereOptions=\"{ Key: \'txtLike\', \'Contract\': \'like\' }\"");

WriteLiteral(" />\r\n\r\n        <div");

WriteLiteral(" class=\"moreSearchPanel\"");

WriteLiteral(">\r\n\r\n");

WriteLiteral("            ");

            
            #line 234 "..\..\Views\DesTask\ProjectProgressList.cshtml"
       Write(BaseData.getBases(new Params() { isMult = true, engName = "ProjProperty", queryOptions = "{ Key:'ProjPropertyID', Contract:'in',filedType:'Int'}" }));

            
            #line default
            #line hidden
WriteLiteral("\r\n\r\n            立项时间\r\n            <input");

WriteLiteral(" id=\"startTime\"");

WriteLiteral(" type=\"text\"");

WriteLiteral(" class=\"easyui-datebox\"");

WriteLiteral(" validtype=\"dateISO\"");

WriteLiteral(" style=\"width:110px\"");

WriteLiteral(" data-options=\"prompt: \'开始时间\'\"");

WriteLiteral(" JQWhereOptions=\"{ Key:\'DateCreateS\', Contract:\'>=\',filedType:\'Date\' }\"");

WriteLiteral(">\r\n            至\r\n            <input");

WriteLiteral(" id=\"endTime\"");

WriteLiteral(" type=\"text\"");

WriteLiteral(" class=\"easyui-datebox\"");

WriteLiteral(" validtype=\"dateISO\"");

WriteLiteral(" style=\"width:110px\"");

WriteLiteral(" data-options=\"prompt: \'完成时间\'\"");

WriteLiteral(" JQWhereOptions=\"{ Key:\'DateCreateE\', Contract:\'<=\',filedType:\'Date\' }\"");

WriteLiteral(">&nbsp;\r\n            计划完成时间\r\n            <input");

WriteLiteral(" id=\"startTime\"");

WriteLiteral(" type=\"text\"");

WriteLiteral(" class=\"easyui-datebox\"");

WriteLiteral(" validtype=\"dateISO\"");

WriteLiteral(" style=\"width:110px\"");

WriteLiteral(" data-options=\"prompt: \'开始时间\'\"");

WriteLiteral(" JQWhereOptions=\"{ Key:\'DatePlanFinishS\', Contract:\'>=\',filedType:\'Date\' }\"");

WriteLiteral(">\r\n            至\r\n            <input");

WriteLiteral(" id=\"endTime\"");

WriteLiteral(" type=\"text\"");

WriteLiteral(" class=\"easyui-datebox\"");

WriteLiteral(" validtype=\"dateISO\"");

WriteLiteral(" style=\"width:110px\"");

WriteLiteral(" data-options=\"prompt: \'完成时间\'\"");

WriteLiteral(" JQWhereOptions=\"{ Key:\'DatePlanFinishE\', Contract:\'<=\',filedType:\'Date\' }\"");

WriteLiteral(">&nbsp;\r\n        </div>\r\n    </div>\r\n    <input");

WriteLiteral(" type=\"hidden\"");

WriteLiteral(" id=\"IsShowFile\"");

WriteLiteral(" name=\"IsShowFile\"");

WriteLiteral(" value=\"1\"");

WriteLiteral(" />\r\n    <input");

WriteLiteral(" type=\"hidden\"");

WriteLiteral(" id=\"category\"");

WriteLiteral(" name=\"category\"");

WriteLiteral(" value=\"0\"");

WriteLiteral(" />\r\n");

});

WriteLiteral("}\r\n\r\n");

        }
    }
}
#pragma warning restore 1591
