#pragma warning disable 1591
//------------------------------------------------------------------------------
// <auto-generated>
//     此代码由工具生成。
//     运行时版本:4.0.30319.42000
//
//     对此文件的更改可能会导致不正确的行为，并且如果
//     重新生成代码，这些更改将会丢失。
// </auto-generated>
//------------------------------------------------------------------------------

namespace ASP
{
    using System;
    using System.Collections.Generic;
    using System.IO;
    using System.Linq;
    using System.Net;
    using System.Text;
    using System.Web;
    using System.Web.Helpers;
    using System.Web.Mvc;
    using System.Web.Mvc.Ajax;
    using System.Web.Mvc.Html;
    using System.Web.Routing;
    using System.Web.Security;
    using System.Web.UI;
    using System.Web.WebPages;
    
    [System.CodeDom.Compiler.GeneratedCodeAttribute("RazorGenerator", "2.0.0.0")]
    [System.Web.WebPages.PageVirtualPathAttribute("~/Views/DesTask/TaskWorkList.cshtml")]
    public partial class _Views_DesTask_TaskWorkList_cshtml : System.Web.Mvc.WebViewPage<dynamic>
    {
        public _Views_DesTask_TaskWorkList_cshtml()
        {
        }
        public override void Execute()
        {
            
            #line 1 "..\..\Views\DesTask\TaskWorkList.cshtml"
  
    Layout = "~/Areas/Core/Views/Shared/_Layout.cshtml";

            
            #line default
            #line hidden
WriteLiteral("\r\n\r\n");

DefineSection("Body_Content", () => {

WriteLiteral("\r\n\r\n    <div");

WriteLiteral(" id=\"DesTaskPanel\"");

WriteLiteral(" JQPanel=\"searchPanel\"");

WriteLiteral(" style=\"padding:5px;height:auto;\"");

WriteLiteral(">\r\n        <span");

WriteLiteral(" JQPanel=\"toolbarPanel\"");

WriteLiteral(">\r\n        </span>\r\n\r\n        <input");

WriteLiteral(" id=\"JQSearch\"");

WriteLiteral(" style=\"width:250px;\"");

WriteLiteral(" JQWhereOptions=\"{ Key:\'ItemPath1,ItemPath2\', Contract:\'like\'}\"");

WriteLiteral(" />\r\n    </div>\r\n    <table");

WriteLiteral(" id=\"DesTaskGrid\"");

WriteLiteral("></table>\r\n\r\n    <script");

WriteLiteral(" type=\"text/javascript\"");

WriteLiteral(">\r\n        var requestUrl = \'");

            
            #line 16 "..\..\Views\DesTask\TaskWorkList.cshtml"
                     Write(Url.Action("TaskWorkListJson", "DesTask", new { @area = "Design" }));

            
            #line default
            #line hidden
WriteLiteral("\';\r\n\r\n        var queryParams = {\r\n            itemStatus: \'");

            
            #line 19 "..\..\Views\DesTask\TaskWorkList.cshtml"
                     Write(ViewBag.ListType);

            
            #line default
            #line hidden
WriteLiteral("\',\r\n            showAll: 1,\r\n            EmpID: (");

            
            #line 21 "..\..\Views\DesTask\TaskWorkList.cshtml"
                Write(ViewBag.EmpId);

            
            #line default
            #line hidden
WriteLiteral(")\r\n        };\r\n\r\n        $(function () {\r\n            JQ.datagrid.datagrid({\r\n   " +
"             JQButtonTypes: [\'export\'],//需要显示的按钮\r\n                JQID: \'DesTask" +
"Grid\',//数据表格ID\r\n                JQDialogTitle: \'信息\',//弹出窗体标题\r\n                JQ" +
"Width: \'768\',//弹出窗体宽\r\n                JQHeight: \'100%\',//弹出窗体高\r\n                " +
"JQLoadingType: \'datagrid\',//数据表格类型 [datagrid,datagrid]\r\n                url: req" +
"uestUrl,//请求的地址\r\n                checkOnSelect: false,//是否包含check\r\n             " +
"   selectOnCheck: false,\r\n                singleSelect: true,\r\n                t" +
"oolbar: \'#DesTaskPanel\',//工具栏的容器ID,\r\n                queryParams: queryParams,\r\n" +
"                JQExcludeCol: [6],\r\n                columns: [[\r\n               " +
"     {\r\n                        title: \'任务路径\', field: \'ItemPathText\', align: \'le" +
"ft\', formatter: function (value, row, index) {\r\n                            var " +
"itemPathText = \"\";\r\n                            if (row.ItemPath1 == \"\" || row.I" +
"temPath2 == \"\") {\r\n                                itemPathText = row.ItemName.e" +
"scapeHTML();\r\n                                row.ItemPathText = row.ItemName;\r\n" +
"                            } else {\r\n                                itemPathTe" +
"xt = createTaskPath(row);\r\n                                row.ItemPathText = cr" +
"eateTaskPathText(row);\r\n                            }\r\n                         " +
"   return itemPathText;\r\n                        }\r\n                    },\r\n    " +
"                { title: \'执行人\', field: \'ItemEmpName\', width: 80, align: \'center\'" +
", sortable: false },\r\n\t\t            { title: \'计划开始\', field: \'DatePlanStart\', wid" +
"th: 80, align: \'center\', sortable: false, formatter: JQ.tools.DateTimeFormatterB" +
"yT },\r\n\t\t            { title: \'计划完成\', field: \'DatePlanFinish\', width: 80, align:" +
" \'center\', sortable: false, formatter: JQ.tools.DateTimeFormatterByT },\r\n       " +
"             { title: \'实际完成\', field: \'DateActualFinish\', width: 140, align: \'lef" +
"t\', sortable: false, formatter: function (value, row, index) {\r\n                " +
"        var result = \"\";\r\n                        var showWarring = false;\r\n    " +
"                    var datePlanStart = Date.jsonStringToDate(row.DatePlanStart)" +
";\r\n                        var datePlanFinish = Date.jsonStringToDate(row.DatePl" +
"anFinish);\r\n                        var dateActualFinish = Date.jsonStringToDate" +
"(row.DateActualFinish);\r\n                        var noDateActualFinish = dateAc" +
"tualFinish.getFullYear() == 1900;\r\n\r\n                        if (datePlanStart.g" +
"etFullYear() > 1900 && datePlanFinish.getFullYear() == 1900) {\r\n                " +
"            // 只有计划开始时间\r\n                        } else if (datePlanStart.getFul" +
"lYear() == 1900 && datePlanFinish.getFullYear() > 1900) {\r\n                     " +
"       // 只有计划结束时间\r\n                            showWarring = (noDateActualFinis" +
"h ? new Date() : dateActualFinish).dateDiff(\'s\', datePlanFinish) < 0\r\n          " +
"              } else if (datePlanStart.getFullYear() > 1900 && datePlanFinish.ge" +
"tFullYear() > 1900) {\r\n                            // 计划开始结束时间都有\r\n              " +
"              showWarring = (noDateActualFinish ? new Date() : dateActualFinish)" +
".dateDiff(\'s\', datePlanFinish) < 0\r\n                        } else {\r\n          " +
"                  // 计划开始结束时间都没有\r\n                        }\r\n                   " +
"     result = \'<span class=\"{2}\">{0}{1}</span>\'.format(\r\n                       " +
"     (noDateActualFinish ? \'\' : dateActualFinish.format(\'yyyy-MM-dd \')), \r\n     " +
"                       (showWarring ? (noDateActualFinish ? \'超期未完成\' : \'超期完成\') : " +
"\'\'), \r\n                            (showWarring ? \'label label-important\' : \'\')\r" +
"\n                        );\r\n\r\n                        row.DateActualFinish =JQ." +
"tools.DateTimeFormatterByT(value, row, index);\r\n                        return r" +
"esult;\r\n                    } },\r\n                    {\r\n                       " +
" title: \'操作\', field: \'ItemAction\', width: 90, align: \'center\', formatter: functi" +
"on (value, row, index) {\r\n                            var title = value + \"：\" + " +
"row.ItemPathText.escapeHTML();\r\n                            return \"<a href=\\\"ja" +
"vascript:void(0);\\\" btnAction class=\\\"easyui-linkbutton\\\" data-options=\\\"plain:t" +
"rue\\\" onclick=\'openDialog(\\\"\" + title + \"\\\",\" + row.ItemType + \",\" + row.ProjId " +
"+ \",\" + row.TaskGroupId + \",\" + row.TaskId + \",\" + row.TabId + \")\'>\" + value + \"" +
"</a>\";\r\n                        }\r\n                    }\r\n                ]],\r\n " +
"               onLoadSuccess: function (data) {\r\n                    setBtnActio" +
"n();\r\n                }\r\n            });\r\n\r\n            $(\"#JQSearch\").textbox({" +
"\r\n                buttonText: \'筛选\',\r\n                buttonIcon: \'fa fa-search\'," +
"\r\n                height: 25,\r\n                prompt: \'项目名称、任务名称\',\r\n           " +
"     onClickButton: function () {\r\n                    JQ.datagrid.searchGrid({\r" +
"\n                        dgID: \'DesTaskGrid\',\r\n                        loadingTy" +
"pe: \'datagrid\',\r\n                        queryParams: queryParams\r\n             " +
"       });\r\n                }\r\n            });\r\n        });\r\n\r\n\r\n\r\n        // 获取" +
"任务路径（纯文本）\r\n        function createTaskPathText(row) {\r\n            var jsonItemP" +
"ath1 = row.ItemPath1;\r\n            var jsonItemPath2 = row.ItemPath2;\r\n\r\n       " +
"     var separator = \" ＞ \";\r\n            var arrItemPath1 = JSON.parse(jsonItemP" +
"ath1);\r\n            var arrItemPath2 = JSON.parse(jsonItemPath2);\r\n\r\n           " +
" var path1 = (Enumerable.From(arrItemPath1).OrderBy(\"x=>x.rownum\").Select(functi" +
"on (x) { return x.text; }).ToArray());\r\n            var path2 = (Enumerable.From" +
"(arrItemPath2).OrderBy(\"x=>x.rownum\").Select(function (x) { return x.text; }).To" +
"Array());\r\n            var path = [];\r\n            if (path1 != undefined && pat" +
"h1 != null) {\r\n                path.push(path1.join(separator));\r\n            }\r" +
"\n            if (path2 != undefined && path2 != null && path2.length > 0) {\r\n   " +
"             path.push(path2.join(separator));\r\n            }\r\n\r\n            swi" +
"tch (row.ItemType) {\r\n                case 5:\r\n                    path.push(\"{0" +
"}\".format(row.ItemName));\r\n                    break;\r\n            }\r\n\r\n        " +
"    return path.join(separator);\r\n\r\n        }\r\n\r\n        // 获取任务路径（带LinkButton）\r" +
"\n        function createTaskPath(row) {\r\n            var jsonItemPath1 = row.Ite" +
"mPath1;\r\n            var jsonItemPath2 = row.ItemPath2;\r\n\r\n            var separ" +
"ator = \"<i class=\'fa fa-caret-right\' style=\'margin: 0 5px;\'></i>\";\r\n            " +
"var arrItemPath1 = JSON.parse(jsonItemPath1);\r\n            var arrItemPath2 = JS" +
"ON.parse(jsonItemPath2);\r\n\r\n            var path1 = (Enumerable.From(arrItemPath" +
"1).OrderBy(\"x=>x.rownum\").Select(function (x) { return createLinkButton(x); }).T" +
"oArray());\r\n            var path2 = (Enumerable.From(arrItemPath2).OrderBy(\"x=>x" +
".rownum\").Select(function (x) { return createLinkButton(x); }).ToArray());\r\n    " +
"        // 给当前操作节点追加状态图标，和点击操作\r\n            if (path2 != undefined && path2 != n" +
"ull && path2.length > 0) {\r\n                setPathActionStatusIcon(path2, row);" +
"\r\n            } else {\r\n                setPathActionStatusIcon(path1, row);\r\n  " +
"          }\r\n            // 拼接两部分路径\r\n            var path = [];\r\n            if " +
"(path1 != undefined && path1 != null) {\r\n                path.push(path1.join(se" +
"parator));\r\n            }\r\n            if (path2 != undefined && path2 != null &" +
"& path2.length > 0) {\r\n                path.push(path2.join(separator));\r\n      " +
"      }\r\n            // 会签在原有任务路径后，再追加会签路径\r\n            if (row.ItemType == 5) {" +
"\r\n                path.push(createLinkButton({\r\n                    active: \"Mut" +
"iSign\",\r\n                    text: row.ItemName,\r\n                    value: row" +
".TabId\r\n                }));\r\n            }\r\n\r\n            return path.join(sepa" +
"rator);\r\n\r\n        }\r\n\r\n        function createLinkButton(data) {\r\n            /" +
"/data = {\"rownum\":1,\"value\":34,\"text\":\"常州河海路110kV输变电2#主变扩建工程\",\"active\":\"TaskGrou" +
"p\"}\r\n            var btn = \'<a href=\"javascript:void(0);\" onclick=\"clickLinkButt" +
"on(this, \\\'{0}\\\', \\\'{1}\\\', {2})\">{1}</a>\'.format(data.active, data.text, data.va" +
"lue);\r\n            return btn;\r\n        }\r\n\r\n        function clickLinkButton(_t" +
"his, active, text, id) {\r\n            var url = \"\";\r\n            switch (active)" +
" {\r\n                case \"Project\":\r\n                    //  项目查看页面\r\n           " +
"         url = _webconfig.serverUrl + \'Project/Project/ProjInfoOnlyRead?id=\' + i" +
"d;\r\n                    JQ.dialog.dialog({\r\n                        title: \'{0}\'" +
".format(text),\r\n                        url: url,\r\n                        width" +
": 1024,\r\n                        height: 900,\r\n                        onClose: " +
"function () {\r\n                        }\r\n                    });\r\n             " +
"       break;\r\n                case \"ProjPhase\":\r\n                    //  阶段查看页面" +
"\r\n                    url = _webconfig.serverUrl + \'Design/DesTask/TaskPhaseInfo" +
"?id=\' + id;\r\n                    JQ.dialog.dialog({\r\n                        tit" +
"le: \'{0}\'.format(text),\r\n                        url: url,\r\n                    " +
"    width: 500,\r\n                        height: 500,\r\n                        o" +
"nClose: function () {\r\n                        }\r\n                    });\r\n     " +
"               break;\r\n                case \"TaskGroup\":\r\n                    //" +
"  分组查看页面\r\n                    url = _webconfig.serverUrl + \'Design/DesTask/TaskG" +
"roupInfo?id=\' + id;\r\n                    JQ.dialog.dialog({\r\n                   " +
"     title: \'{0}\'.format(text),\r\n                        url: url,\r\n            " +
"            width: 500,\r\n                        height: 500,\r\n                 " +
"       onClose: function () {\r\n                        }\r\n                    })" +
";\r\n                    break;\r\n                case \"TaskSpec\":\r\n               " +
"     //  专业查看页面\r\n                    url = _webconfig.serverUrl + \'Design/DesTas" +
"k/TaskSpecInfo?id=\' + id;\r\n                    JQ.dialog.dialog({\r\n             " +
"           title: \'{0}\'.format(text),\r\n                        url: url,\r\n      " +
"                  width: 500,\r\n                        height: 500,\r\n           " +
"             onClose: function () {\r\n                        }\r\n                " +
"    });\r\n                    break;\r\n                case \"TaskPath\":\r\n         " +
"       case \"Task\":\r\n                    //  任务查看页面\r\n                    url = _" +
"webconfig.serverUrl + \'Design/DesTask/TaskInfo?from=Remind&Id=\' + id;\r\n         " +
"           JQ.dialog.dialog({\r\n                        title: \'{0}\'.format(text)" +
",\r\n                        url: url,\r\n                        width: 1200,\r\n    " +
"                    height: 900,\r\n                        onClose: function () {" +
"\r\n                        }\r\n                    });\r\n                    break;" +
"\r\n                case \"MutiSign\":\r\n                    //  会签查看页面\r\n            " +
"        url = _webconfig.serverUrl + \'Design/DesMutiSign/Edit?from=Remind&Id=\' +" +
" id;\r\n                    JQ.dialog.dialog({\r\n                        title: \'{0" +
"}\'.format(text),\r\n                        url: url,\r\n                        wid" +
"th: 800,\r\n                        height: 800,\r\n                        onClose:" +
" function () {\r\n                        }\r\n                    });\r\n            " +
"        break;\r\n            }\r\n            return btn;\r\n        }\r\n\r\n        // " +
"设置处理节点状态图标\r\n        function setPathActionStatusIcon(path2, row) {\r\n            " +
"//path2 = [{\"rownum\":1,\"value\":34,\"text\":\"常州河海路110kV输变电2#主变扩建工程\",\"active\":\"TaskG" +
"roup\"},{...}]\r\n            var icon = \"\";\r\n            var title = \"\";\r\n        " +
"    switch (row.ItemStatus) {\r\n                case 0:\r\n                    titl" +
"e = \"未启动\";\r\n                    icon = \"fa-circle-o text-muted\";\r\n              " +
"      break;\r\n                case 1:\r\n                    title = \"已轮到\";\r\n     " +
"               icon = \"fa-dot-circle-o text-warning\";\r\n                    break" +
";\r\n                case 2:\r\n                    title = \"进行中\";\r\n                " +
"    icon = \"fa-play-circle text-success\";\r\n                    break;\r\n         " +
"       case 3:\r\n                    title = \"已完成\";\r\n                    icon = \"" +
"fa-check-circle text-info\";\r\n                    break;\r\n                case 4:" +
"\r\n                    title = row.ItemType == 1 ? \"已停止\" : \"已回退\";\r\n              " +
"      icon = \"fa-minus-circle text-danger\";\r\n                    break;\r\n       " +
"     }\r\n            row.ItemStatusName = title;\r\n            var status = \"<i cl" +
"ass=\\\"fa \" + icon + \"\\\" title=\\\"\" + title + \"\\\"></i>&nbsp;\";\r\n            path2[" +
"path2.length - 1] = status + path2[path2.length - 1];\r\n        }\r\n\r\n        // 设" +
"置处理节点状态图标\r\n        function setBtnAction() {\r\n            var btnColor = \"\";\r\n  " +
"          switch (queryParams.itemStatus.toLocaleLowerCase()) {\r\n               " +
" case \'waiting\':\r\n                    //已安排\r\n                    btnColor = \"nod" +
"e-status-1\";\r\n                    break;\r\n                case \'now\':\r\n         " +
"       case \'remind\':\r\n                    //进行中\r\n                    btnColor =" +
" \"node-status-2\";\r\n                    break;\r\n                case \'finished\':\r" +
"\n                    //已完成\r\n                    btnColor = \"node-status-3\";\r\n   " +
"                 break;\r\n                case \'back\':\r\n                    //已回退" +
"\r\n                    btnColor = \"node-status-5\";\r\n                    break;\r\n " +
"           }\r\n            $(\"a[btnAction]\").addClass(btnColor).linkbutton();\r\n  " +
"      }\r\n\r\n        function openDialog(title, itemType, projId, taskGroupId, tas" +
"kId, tabId) {\r\n            var url = \"\";\r\n            switch (itemType) {\r\n     " +
"           case 1:\r\n                    //  项目策划\r\n                    if (tabId " +
"== 0) {\r\n                        url = \'");

            
            #line 329 "..\..\Views\DesTask\TaskWorkList.cshtml"
                          Write(Url.Action("PlanTableInfo", "DesTask", new { @area="Design"}));

            
            #line default
            #line hidden
WriteLiteral("?from=Remind&tabId=\' + tabId + \'&projID=\' + projId + \'&taskGroupId=\' + taskGroupI" +
"d;\r\n                    } else {\r\n                        url = \'");

            
            #line 331 "..\..\Views\DesTask\TaskWorkList.cshtml"
                          Write(Url.Action("ProjectPlanInfo", "DesTask", new { @area="Design"}));

            
            #line default
            #line hidden
WriteLiteral(@"?from=Remind&tabId=' + tabId + '&projID=' + projId + '&taskGroupId=' + taskGroupId;
                    }
                    //window.top.addTab(title, url, """");
                    JQ.dialog.dialogIframe({
                        title: title,
                        url: url,
                        width: 1366,
                        height: 800,
                        onClose: function () {
                            $(""#DesTaskGrid"").datagrid(""reload"");
                        }
                    });
                    break;
                case 2:
                    //  专业策划
                    url = '");

            
            #line 346 "..\..\Views\DesTask\TaskWorkList.cshtml"
                      Write(Url.Action("SpecPlanInfo", "DesTask", new { @area="Design"}));

            
            #line default
            #line hidden
WriteLiteral(@"?from=Remind&tabId=' + tabId + '&projID=' + projId + '&taskGroupId=' + taskGroupId;
                    //window.top.addTab(title, url, """");
                    JQ.dialog.dialogIframe({
                        title: title,
                        url: url,
                        width: 1366,
                        height: 800,
                        onClose: function () {
                            $(""#DesTaskGrid"").datagrid(""reload"");
                        }
                    });
                    break;
                case 3:
                    //  提交设计
                    url = '");

            
            #line 360 "..\..\Views\DesTask\TaskWorkList.cshtml"
                      Write(Url.Action("TaskInfo", "DesTask",new { @area="Design"}));

            
            #line default
            #line hidden
WriteLiteral(@"?from=Remind&Id=' + taskId;
                    JQ.dialog.dialog({
                        title: title,
                        url: url,
                        width: 1200,
                        height: 800,
                        onClose: function () {
                            $(""#DesTaskGrid"").datagrid(""reload"");
                        }
                    });
                    break;
                case 4:
                    //  设计校审
                    url = '");

            
            #line 373 "..\..\Views\DesTask\TaskWorkList.cshtml"
                      Write(Url.Action("TaskInfoApprove", "DesTask",new { @area="Design"}));

            
            #line default
            #line hidden
WriteLiteral(@"?from=Remind&Id=' + taskId;
                    JQ.dialog.dialog({
                        title: title,
                        url: url,
                        width: 1200,
                        height: 800,
                        onClose: function () {
                            $(""#DesTaskGrid"").datagrid(""reload"");
                        }
                    });
                    break;
                case 5:
                    //会签任务
                    debugger;
                    url = '");

            
            #line 387 "..\..\Views\DesTask\TaskWorkList.cshtml"
                      Write(Url.Action("Edit", "DesMutiSign", new { @area="Design"}));

            
            #line default
            #line hidden
WriteLiteral(@"?from=Remind&Id=' + tabId + '&RecID=' + taskGroupId;
                    JQ.dialog.dialog({
                        title: title,
                        url: url,
                        width: 800,
                        height: 800,
                        onClose: function () {
                            $(""#DesTaskGrid"").datagrid(""reload"");
                        }
                    });
                    break;
            }
        }
    </script>
");

});

WriteLiteral("\r\n");

        }
    }
}
#pragma warning restore 1591
