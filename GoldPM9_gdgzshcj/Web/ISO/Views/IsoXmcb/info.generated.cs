#pragma warning disable 1591
//------------------------------------------------------------------------------
// <auto-generated>
//     此代码由工具生成。
//     运行时版本:4.0.30319.42000
//
//     对此文件的更改可能会导致不正确的行为，并且如果
//     重新生成代码，这些更改将会丢失。
// </auto-generated>
//------------------------------------------------------------------------------

namespace ASP
{
    using System;
    using System.Collections.Generic;
    using System.IO;
    using System.Linq;
    using System.Net;
    using System.Text;
    using System.Web;
    using System.Web.Helpers;
    using System.Web.Mvc;
    using System.Web.Mvc.Ajax;
    using System.Web.Mvc.Html;
    using System.Web.Routing;
    using System.Web.Security;
    using System.Web.UI;
    using System.Web.WebPages;
    
    #line 2 "..\..\Views\IsoXmcb\info.cshtml"
    using JQ.Web;
    
    #line default
    #line hidden
    
    [System.CodeDom.Compiler.GeneratedCodeAttribute("RazorGenerator", "2.0.0.0")]
    [System.Web.WebPages.PageVirtualPathAttribute("~/Views/IsoXmcb/info.cshtml")]
    public partial class _Views_IsoXmcb_info_cshtml : System.Web.Mvc.WebViewPage<DataModel.Models.IsoXMCB>
    {
        public _Views_IsoXmcb_info_cshtml()
        {
        }
        public override void Execute()
        {
WriteLiteral("<script");

WriteLiteral(" type=\"text/javascript\"");

WriteLiteral(">\r\n    var  btnPer=");

            
            #line 4 "..\..\Views\IsoXmcb\info.cshtml"
           Write(Html.Raw(ViewBag.permission));

            
            #line default
            #line hidden
WriteLiteral(@";
    JQ.form.submitInit({
        formid: 'IsoXMCBForm',//formid提交需要用到
        buttonTypes: ['close','exportForm'],//默认按钮
        docName: 'IsoXMCB',
        beforeFormSubmit: function () {
            TreeGridRowEditEnd();
        },
        succesCollBack: function (data) {//成功回调函数,data为服务器返回值
            var _tempFrame = window.top.document.getElementById(""");

            
            #line 13 "..\..\Views\IsoXmcb\info.cshtml"
                                                             Write(Request.QueryString["iframeID"]);

            
            #line default
            #line hidden
WriteLiteral("\");\r\n            if (_tempFrame) {\r\n                _tempFrame.contentWindow.refr" +
"eshGrid();\r\n            }\r\n            _flowInstance.$form.parent().dialog(\"clos" +
"e\");\r\n        },\r\n        flow: {\r\n            flowNodeID: \"");

            
            #line 20 "..\..\Views\IsoXmcb\info.cshtml"
                     Write(Request.QueryString["flowNodeID"]==null? 0 : int.Parse(Request.QueryString["flowNodeID"]));

            
            #line default
            #line hidden
WriteLiteral("\",\r\n            flowMultiSignID: \"");

            
            #line 21 "..\..\Views\IsoXmcb\info.cshtml"
                          Write(Request.QueryString["flowMultiSignID"] ==null? 0 : int.Parse(Request.QueryString["flowMultiSignID"]));

            
            #line default
            #line hidden
WriteLiteral("\",\r\n            url: \"");

            
            #line 22 "..\..\Views\IsoXmcb\info.cshtml"
              Write(Url.Action("FlowWidget", "PubFlow",new { @area="Core"} ));

            
            #line default
            #line hidden
WriteLiteral("\",\r\n            instance: \"_flowInstance\",\r\n            processor: \"ISO,ISO.FlowP" +
"rocessor.IsoXMCBFlow\",\r\n            refID: \"");

            
            #line 25 "..\..\Views\IsoXmcb\info.cshtml"
                Write(Model.Id);

            
            #line default
            #line hidden
WriteLiteral("\",\r\n            refTable: \"IsoXMCB\",\r\n            dataCreator: \"");

            
            #line 27 "..\..\Views\IsoXmcb\info.cshtml"
                      Write(ViewBag.CreatorEmpId);

            
            #line default
            #line hidden
WriteLiteral(@""",
            getStepUsers: function (step, action) {

            },
            onLoaded: function () {
                $(""#stepOrder"").val(this.stepOrder);
            }
        },
        onBefore: function (resultArr) {
            var bit=""0"";
            if($.inArray(""allDown"", btnPer)!=-1){
                bit=""1"";
            }
            resultArr.push({ Key: ""Permission"", Value: bit});
        }
    });
    function SelectProjectInfo() {
        JQ.dialog.dialog({
            title: ""选择项目信息"",
            url: '");

            
            #line 46 "..\..\Views\IsoXmcb\info.cshtml"
             Write(Url.Action("ChooseProjectList1", "EmpManage", new { @area = "Engineering" }));

            
            #line default
            #line hidden
WriteLiteral(@"?CompanyType=FGS&TaskGroupId=0',
            width: '1024',
            height: '100%',
            JQID: 'ShowProjectTreeGridList',
            JQLoadingType: 'datagrid',
            iconCls: 'fa fa-plus',
        });
    }
    var _ProjCallBack = function (param) {

        $(""#projId"").val(param[0].Id);
        $(""#projPhaseId"").val(param[0].ProjPhaseId);
        $(""#desTaskGroupId"").val(param[0].TaskGroupId);
        $(""#CompanyID"").val(param[0].CompanyID);

        $(""#ProjNumber"").textbox('setValue', param[0].ProjNumber);
        $(""#ProjName"").textbox('setValue', param[0].ProjName);
    }

    $(function () {
        if(");

            
            #line 66 "..\..\Views\IsoXmcb\info.cshtml"
       Write(Model.Id);

            
            #line default
            #line hidden
WriteLiteral(">0)\r\n        {\r\n            $(\"#projId\").val(");

            
            #line 68 "..\..\Views\IsoXmcb\info.cshtml"
                        Write(Model.ProjID);

            
            #line default
            #line hidden
WriteLiteral(");\r\n            $(\"#projPhaseId\").val(");

            
            #line 69 "..\..\Views\IsoXmcb\info.cshtml"
                             Write(Model.ProjPhaseId);

            
            #line default
            #line hidden
WriteLiteral(");\r\n            $(\"#desTaskGroupId\").val(");

            
            #line 70 "..\..\Views\IsoXmcb\info.cshtml"
                                Write(Model.DesTaskGroupId);

            
            #line default
            #line hidden
WriteLiteral(");\r\n            $(\"#CompanyID\").val(");

            
            #line 71 "..\..\Views\IsoXmcb\info.cshtml"
                           Write(Model.CompanyID);

            
            #line default
            #line hidden
WriteLiteral(@");
        }
        ShowTreegrid();
    })

    function ShowTreegrid()
    {
        JQ.treegrid.treegrid({
            idField: 'Id',
            fit: false,
            pagination: false,
            treeField: 'ModelName',
            JQID: 'ProjCostGrid',//数据表格ID
            JQLoadingType: 'treegrid',//数据表格类型 [datagrid,treegrid]
            url: '");

            
            #line 85 "..\..\Views\IsoXmcb\info.cshtml"
             Write(Url.Action("GetCostList", "Project",new { @area="Project"}));

            
            #line default
            #line hidden
WriteLiteral("?IsoXMCBId=\'+");

            
            #line 85 "..\..\Views\IsoXmcb\info.cshtml"
                                                                                      Write(Model.Id);

            
            #line default
            #line hidden
WriteLiteral(",//请求的地址\r\n            checkOnSelect: false,//是否包含check\r\n            expandAll:tru" +
"e,\r\n            columns: [[\r\n                { title: \'成本项\', field: \'ModelName\'," +
" width: 420, align: \'left\' },\r\n                {\r\n                    title: \'实际" +
"金额(元)\', field: \'ModelFactFee\', width: 150, align: \'left\',\r\n                    e" +
"ditor: {\r\n                        type: \"numberbox\",\r\n                        op" +
"tions:{\r\n                            precision:2\r\n                        }\r\n   " +
"                 }\r\n                }\r\n            ]]\r\n        });\r\n    }\r\n\r\n   " +
" $.extend($.fn.treegrid.defaults.view, {\r\n        onAfterRender: function (targe" +
"t) {\r\n            if( $(\"#stepOrder\").val()==1)\r\n            {\r\n                " +
"var gridRoots = $(target).treegrid(\"getRoots\");\r\n                $.each(gridRoot" +
"s, function (i, n) {\r\n                    TreeGridRowEdit(target, n);\r\n         " +
"           var rowChildren = $(target).treegrid(\"getChildren\", n.Id);\r\n         " +
"           $.each(rowChildren, function (k, m) {\r\n                        TreeGr" +
"idRowEdit(target, m);\r\n                    });\r\n                });\r\n           " +
" }\r\n        }\r\n    });\r\n\r\n    function TreeGridRowEdit(target, model) {\r\n       " +
" if (model.ModelIsType == 0)  //不是标题\r\n        {\r\n            if (model.ModelTemp" +
"Fee == 0) model.ModelTempFee = \"\";\r\n            if (model.ModelFactFee == 0) mod" +
"el.ModelFactFee = \"\";\r\n\r\n            $(target).treegrid(\"beginEdit\", model.Id);\r" +
"\n\r\n            if (model.ModelIsSum == 1) {\r\n\r\n                $($(target).treeg" +
"rid(\"getEditor\", { id: model.Id, field: \"ModelFactFee\" }).target[0]).numberbox({" +
"\r\n                    onChange: function (newValue, oldValue) {\r\n               " +
"         CalculateCost(target, model, newValue, oldValue, \"ModelFactFee\");\r\n    " +
"                }\r\n                });\r\n            }\r\n        }\r\n    }\r\n    fun" +
"ction TreeGridRowEditEnd() {\r\n        var gridRoots = $(\"#ProjCostGrid\").treegri" +
"d(\"getRoots\");\r\n        $.each(gridRoots, function (i, n) {\r\n            $(\"#Pro" +
"jCostGrid\").treegrid(\"endEdit\", n.Id);\r\n            var rowChildren = $(\"#ProjCo" +
"stGrid\").treegrid(\"getChildren\", n.Id);\r\n            $.each(rowChildren, functio" +
"n (k, m) {\r\n                if (m.ModelFactFee == \"\") m.ModelFactFee = 0;\r\n     " +
"           $(\"#ProjCostGrid\").treegrid(\"endEdit\", m.Id);\r\n            });\r\n     " +
"   });\r\n\r\n        $(\"#HiddenData\").val(JSON.stringify($(\"#ProjCostGrid\").treegri" +
"d(\"getData\")));\r\n        if( $(\"#stepOrder\").val()==1)\r\n        {\r\n            $" +
".each(gridRoots, function (i, n) {\r\n                TreeGridRowEdit(ProjCostGrid" +
", n);\r\n                var rowChildren = $(ProjCostGrid).treegrid(\"getChildren\"," +
" n.Id);\r\n\r\n                $.each(rowChildren, function (k, m) {\r\n              " +
"      TreeGridRowEdit(ProjCostGrid, m);\r\n                });\r\n            });\r\n " +
"       }\r\n    }\r\n\r\n    function CalculateCost(target, model, newValue, oldValue," +
" name) {\r\n        if (model.ParentId != 0) {\r\n            var parentVal = $(targ" +
"et).treegrid(\"find\", model.ParentId)[name] || 0;\r\n            var oldVal = oldVa" +
"lue || 0;\r\n            newValue=newValue||0;\r\n            var rowData = {};\r\n   " +
"         var s=(isNaN(parseFloat(parentVal))==false?parseFloat(parentVal):0 )+(i" +
"sNaN(parseFloat(newValue))==false?parseFloat(newValue):0)-(isNaN(parseFloat(oldV" +
"al))==false?parseFloat(oldVal):0);\r\n            rowData[name] = s.toFixed(4);\r\n " +
"           $(target).treegrid(\'update\', {\r\n                id: model.ParentId,\r\n" +
"                row: rowData\r\n            });\r\n            CalculateCost(target," +
" $(target).treegrid(\"find\", model.ParentId), newValue, oldValue, name);\r\n       " +
" }\r\n    }\r\n</script>\r\n");

            
            #line 178 "..\..\Views\IsoXmcb\info.cshtml"
 using (Html.BeginForm("save", "IsoXMCB", FormMethod.Post, new { @area = "Iso", @id = "IsoXMCBForm" }))
{
    
            
            #line default
            #line hidden
            
            #line 180 "..\..\Views\IsoXmcb\info.cshtml"
Write(Html.HiddenFor(m => m.Id));

            
            #line default
            #line hidden
            
            #line 180 "..\..\Views\IsoXmcb\info.cshtml"
                              

            
            #line default
            #line hidden
WriteLiteral("    <table");

WriteLiteral(" class=\"table table-bordered\"");

WriteLiteral(">\r\n        <div");

WriteLiteral(" style=\"width:100%;text-align:center;font-size:20px;font-weight:bold;margin-top:1" +
"0px;\"");

WriteLiteral(">\r\n            <a>项目成本</a>\r\n        </div>\r\n        <tr>\r\n            <th");

WriteLiteral(" width=\"10%\"");

WriteLiteral(" rowspan=\"2\"");

WriteLiteral(">\r\n                项目编号\r\n            </th>\r\n            <td");

WriteLiteral(" colspan=\"3\"");

WriteLiteral(">\r\n                <a");

WriteLiteral(" class=\"easyui-linkbutton\"");

WriteLiteral(" name=\"btnChoiceProject\"");

WriteLiteral(" data-options=\"plain:true,iconCls:\'fa fa-plus\'\"");

WriteLiteral(" onclick=\"SelectProjectInfo()\"");

WriteLiteral(">选择项目信息</a>\r\n            </td>\r\n\r\n        </tr>\r\n        <tr>\r\n            <td");

WriteLiteral(" width=\"40%\"");

WriteLiteral(">\r\n                <input");

WriteLiteral(" name=\"ProjNumber\"");

WriteLiteral(" id=\"ProjNumber\"");

WriteLiteral(" style=\"width:98%;\"");

WriteLiteral(" class=\"easyui-textbox\"");

WriteLiteral(" validType=\"length[0,500]\"");

WriteAttribute("value", Tuple.Create(" value=\"", 7693), Tuple.Create("\"", 7720)
            
            #line 196 "..\..\Views\IsoXmcb\info.cshtml"
                                                    , Tuple.Create(Tuple.Create("", 7701), Tuple.Create<System.Object, System.Int32>(ViewBag.ProjNumber
            
            #line default
            #line hidden
, 7701), false)
);

WriteLiteral(" data-options=\"required:true,readonly:true\"");

WriteLiteral(" />\r\n            </td>\r\n            <th");

WriteLiteral(" width=\"10%\"");

WriteLiteral(">项目名称</th>\r\n            <td");

WriteLiteral(" width=\"40%\"");

WriteLiteral(">\r\n                <input");

WriteLiteral(" name=\"ProjName\"");

WriteLiteral(" id=\"ProjName\"");

WriteLiteral(" style=\"width:98%;\"");

WriteLiteral(" class=\"easyui-textbox\"");

WriteLiteral(" validType=\"length[0,500]\"");

WriteAttribute("value", Tuple.Create(" value=\"", 7977), Tuple.Create("\"", 8002)
            
            #line 200 "..\..\Views\IsoXmcb\info.cshtml"
                                                , Tuple.Create(Tuple.Create("", 7985), Tuple.Create<System.Object, System.Int32>(ViewBag.ProjName
            
            #line default
            #line hidden
, 7985), false)
);

WriteLiteral(" data-options=\"required:true,readonly:true\"");

WriteLiteral(" />\r\n            </td>\r\n        </tr>\r\n        <tr>\r\n            <th");

WriteLiteral(" width=\"10%\"");

WriteLiteral(">\r\n                成本类型\r\n            </th>\r\n            <td");

WriteLiteral(" colspan=\"3\"");

WriteLiteral(">\r\n                <table");

WriteLiteral(" id=\"ProjCostGrid\"");

WriteLiteral(" treeGrid=\"DetailGrid\"");

WriteLiteral("></table>\r\n            </td>\r\n        </tr>\r\n\r\n\r\n        <tr>\r\n            <th");

WriteLiteral(" width=\"10%\"");

WriteLiteral(">备注</th>\r\n            <td");

WriteLiteral(" colspan=\"3\"");

WriteLiteral(">\r\n                <textarea");

WriteLiteral(" name=\"Contents\"");

WriteLiteral(" style=\"width:99%;height:80px;\"");

WriteLiteral(" class=\"easyui-textbox\"");

WriteLiteral(" data-options=\"multiline:true\"");

WriteLiteral(" validType=\"length[0,1000]\"");

WriteLiteral(">");

            
            #line 216 "..\..\Views\IsoXmcb\info.cshtml"
                                                                                                                                                    Write(Model.Contents);

            
            #line default
            #line hidden
WriteLiteral("</textarea>\r\n            </td>\r\n        </tr>\r\n        <tr");

WriteLiteral(" id=\"SignTd\"");

WriteLiteral(">\r\n            <th></th>\r\n            <td");

WriteLiteral(" colspan=\"3\"");

WriteLiteral("></td>\r\n        </tr>\r\n        <tr>\r\n            <th>\r\n                上传附件\r\n    " +
"        </th>\r\n            <td");

WriteLiteral(" colspan=\"3\"");

WriteLiteral(">\r\n");

            
            #line 228 "..\..\Views\IsoXmcb\info.cshtml"
                
            
            #line default
            #line hidden
            
            #line 228 "..\..\Views\IsoXmcb\info.cshtml"
                  
                    var uploader = new DataModel.FileUploader();
                    uploader.RefID = Model.Id;
                    uploader.RefTable = "IsoXMCB";
                    uploader.Name = "UploadFile1";
                    
            
            #line default
            #line hidden
            
            #line 233 "..\..\Views\IsoXmcb\info.cshtml"
                Write(Html.Partial("~/Areas/Core/Views/UserControl/FileUploader.cshtml", uploader));

            
            #line default
            #line hidden
            
            #line 233 "..\..\Views\IsoXmcb\info.cshtml"
                                                                                                   
                
            
            #line default
            #line hidden
WriteLiteral("\r\n            </td>\r\n        </tr>\r\n    </table>\r\n");

WriteLiteral("    <input");

WriteLiteral(" type=\"hidden\"");

WriteLiteral(" id=\"projId\"");

WriteLiteral(" name=\"projId\"");

WriteLiteral(" value=\"0\"");

WriteLiteral(" />\r\n");

WriteLiteral("    <input");

WriteLiteral(" type=\"hidden\"");

WriteLiteral(" id=\"projPhaseId\"");

WriteLiteral(" name=\"projPhaseId\"");

WriteLiteral(" value=\"0\"");

WriteLiteral(" />\r\n");

WriteLiteral("    <input");

WriteLiteral(" type=\"hidden\"");

WriteLiteral(" id=\"desTaskGroupId\"");

WriteLiteral(" name=\"desTaskGroupId\"");

WriteLiteral(" value=\"0\"");

WriteLiteral(" />\r\n");

WriteLiteral("    <input");

WriteLiteral(" type=\"hidden\"");

WriteLiteral(" id=\"stepOrder\"");

WriteLiteral(" name=\"stepOrder\"");

WriteLiteral(" value=\"0\"");

WriteLiteral(" />\r\n");

WriteLiteral("    <input");

WriteLiteral(" type=\"hidden\"");

WriteLiteral(" id=\"CompanyID\"");

WriteLiteral(" name=\"CompanyID\"");

WriteLiteral(" value=\"0\"");

WriteLiteral(" />\r\n");

WriteLiteral("    <input");

WriteLiteral(" id=\"HiddenData\"");

WriteLiteral(" name=\"HiddenData\"");

WriteLiteral(" type=\"hidden\"");

WriteLiteral(" />\r\n");

            
            #line 244 "..\..\Views\IsoXmcb\info.cshtml"
                    }

            
            #line default
            #line hidden
        }
    }
}
#pragma warning restore 1591
