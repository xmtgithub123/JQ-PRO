#pragma warning disable 1591
//------------------------------------------------------------------------------
// <auto-generated>
//     此代码由工具生成。
//     运行时版本:4.0.30319.42000
//
//     对此文件的更改可能会导致不正确的行为，并且如果
//     重新生成代码，这些更改将会丢失。
// </auto-generated>
//------------------------------------------------------------------------------

namespace ASP
{
    using System;
    using System.Collections.Generic;
    using System.IO;
    using System.Linq;
    using System.Net;
    using System.Text;
    using System.Web;
    using System.Web.Helpers;
    using System.Web.Mvc;
    using System.Web.Mvc.Ajax;
    using System.Web.Mvc.Html;
    using System.Web.Routing;
    using System.Web.Security;
    using System.Web.UI;
    using System.Web.WebPages;
    
    #line 2 "..\..\Views\BussContractOther\infoAddConOtherFee.cshtml"
    using JQ.Web;
    
    #line default
    #line hidden
    
    [System.CodeDom.Compiler.GeneratedCodeAttribute("RazorGenerator", "2.0.0.0")]
    [System.Web.WebPages.PageVirtualPathAttribute("~/Views/BussContractOther/infoAddConOtherFee.cshtml")]
    public partial class _Views_BussContractOther_infoAddConOtherFee_cshtml : System.Web.Mvc.WebViewPage<DataModel.Models.BussContractOther>
    {
        public _Views_BussContractOther_infoAddConOtherFee_cshtml()
        {
        }
        public override void Execute()
        {
WriteLiteral("<script");

WriteLiteral(" type=\"text/javascript\"");

WriteLiteral(@">

        JQ.form.submitInit({
            formid: 'BussContractOtherFeeForm',//formid提交需要用到
            //buttonTypes: ['close'],//默认按钮
            succesCollBack: function (data) {//成功回调函数,data为服务器返回值
                //刷新上一级数据表格，必须在close窗体前调用
                //JQ.dialog.dialogClose();//关闭窗体放在最后一步执行，以避免找不到事件源
            },
            buttons: [
               {
                   icon: ""fa-pencil"",  id: ""eFinish"", text: ""置为结清"", onClick: function () {
                       editIsFeeFinished(true);
                       $(""#toolbar"").children().eq(0).hide();
                       $(""#toolbar"").children().eq(1).show();
                       //JQ.datagrid.autoRefdatagrid();
                   }
               },
               {
                   icon: 'fa-pencil',  id: ""nFinish"", text: ""置为未结清"", onClick: function () {
                       editIsFeeFinished(false);
                       $(""#toolbar"").children().eq(0).show();
                       $(""#toolbar"").children().eq(1).hide();
                       //JQ.datagrid.autoRefdatagrid();
                   }
               },
                {
                    icon: ""fa-close"",  id: ""btnClose"", text: ""关闭"", onClick: function () {
                        onClose();
                    }
                }
            ]
        });



    var ConIsFeeFinished= '");

            
            #line 39 "..\..\Views\BussContractOther\infoAddConOtherFee.cshtml"
                      Write(Model.ConIsFeeFinished);

            
            #line default
            #line hidden
WriteLiteral("\';\r\n    if (ConIsFeeFinished==\"False\") {\r\n        $(\"#toolbar\").children().eq(1)." +
"hide();\r\n    }else {\r\n        $(\"#toolbar\").children().eq(0).hide();\r\n    }\r\n\r\n\r" +
"\n    var editUrl = \'");

            
            #line 47 "..\..\Views\BussContractOther\infoAddConOtherFee.cshtml"
              Write(Url.Action("editIsFeeFinished"));

            
            #line default
            #line hidden
WriteLiteral(@"';

    function onClose() {
        //  JQ.datagrid.autoRefdatagrid();
        JQ.dialog.dialogClose();
    }

    function editIsFeeFinished(isValue) {
        if (isValue == 0) {
            if (!confirm(""是否确定置为未结清状态？"")) {
                return;
            }
        } else {
            if (!confirm(""是否确定置为结清状态？"")) {
                return;
            }
        }

        $.ajax({
            url: """);

            
            #line 66 "..\..\Views\BussContractOther\infoAddConOtherFee.cshtml"
              Write(Url.Action("editIsFeeFinished", "BussContractOther", new { @area = "Bussiness" }));

            
            #line default
            #line hidden
WriteLiteral("\",\r\n            data: { isValue: isValue ,Id:");

            
            #line 67 "..\..\Views\BussContractOther\infoAddConOtherFee.cshtml"
                                    Write(Model.Id);

            
            #line default
            #line hidden
WriteLiteral(@"},
            type: ""POST"",
            success: function (result) {
                if (result.Result == ""0"") {
                    alert(result.Message);
                    return;
                }
            }
        });
    }


    $.extend($.fn.datagrid.defaults.view,{
        onAfterRender:function(target){
            if (target.id==""FeeFactGrid"") {
                if ($(target).datagrid(""getRows"").length==0) {
                    FeeFactAdd();
                }
            }
            else if (target.id==""InvoiceGrid"") {
                if ($(target).datagrid(""getRows"").length==0) {
                    InvoiceAdd();
                }
            }
        }});


</script>
");

            
            #line 95 "..\..\Views\BussContractOther\infoAddConOtherFee.cshtml"
 using (Html.BeginForm("saveIsFeeFinished", "BussContractOther", FormMethod.Post, new { @area = "Bussiness", @id = "BussContractOtherFeeForm" }))
{
    
            
            #line default
            #line hidden
            
            #line 97 "..\..\Views\BussContractOther\infoAddConOtherFee.cshtml"
Write(Html.HiddenFor(m => m.Id));

            
            #line default
            #line hidden
            
            #line 97 "..\..\Views\BussContractOther\infoAddConOtherFee.cshtml"
                              


            
            #line default
            #line hidden
WriteLiteral("    <div");

WriteLiteral(" jqpanel=\'dialogButtonPanel\'");

WriteLiteral(">\r\n\r\n        <table");

WriteLiteral(" class=\"table table-bordered\"");

WriteLiteral(">\r\n            <tr>\r\n                <th");

WriteLiteral(" width=\"10%\"");

WriteLiteral(">合同编号</th>\r\n                <td");

WriteLiteral(" width=\"15%\"");

WriteLiteral(">\r\n");

WriteLiteral("                    ");

            
            #line 105 "..\..\Views\BussContractOther\infoAddConOtherFee.cshtml"
               Write(Model.ConNumber);

            
            #line default
            #line hidden
WriteLiteral("\r\n                </td>\r\n                <th");

WriteLiteral(" width=\"10%\"");

WriteLiteral(">合同名称</th>\r\n                <td>\r\n");

WriteLiteral("                    ");

            
            #line 109 "..\..\Views\BussContractOther\infoAddConOtherFee.cshtml"
               Write(Model.ConrName);

            
            #line default
            #line hidden
WriteLiteral("\r\n                </td>\r\n                <th");

WriteLiteral(" width=\"10%\"");

WriteLiteral(">合同金额(元)</th>\r\n                <td");

WriteLiteral(" width=\"15%\"");

WriteLiteral(">\r\n");

WriteLiteral("                    ");

            
            #line 113 "..\..\Views\BussContractOther\infoAddConOtherFee.cshtml"
               Write(ViewBag.Fee);

            
            #line default
            #line hidden
WriteLiteral("\r\n                </td>\r\n            </tr>\r\n        </table>\r\n\r\n    </div>\r\n");

            
            #line 119 "..\..\Views\BussContractOther\infoAddConOtherFee.cshtml"



            
            #line default
            #line hidden
WriteLiteral("    <table");

WriteLiteral(" id=\"FeeFactGrid\"");

WriteLiteral("></table>\r\n");

WriteLiteral("    <div");

WriteLiteral(" id=\"FeeFactGridPanel\"");

WriteLiteral(" jqpanel=\"searchPanel\"");

WriteLiteral(" style=\"padding:5px;height:auto;\"");

WriteLiteral(">\r\n        <span");

WriteLiteral(" jqpanel=\"toolbarPanel\"");

WriteLiteral(">\r\n            <span");

WriteLiteral(" class=\"label label-default\"");

WriteLiteral("><strong");

WriteLiteral(" style=\"padding:10px;\"");

WriteLiteral(">合同收款<input");

WriteLiteral(" type=\"hidden\"");

WriteLiteral(" name=\"tValue\"");

WriteLiteral(" /></strong></span>\r\n            <span");

WriteLiteral(" class=\'datagrid-btn-separator\'");

WriteLiteral(" style=\'vertical-align: middle; height: 22px;display:inline-block;float:none\'");

WriteLiteral("></span>\r\n            <a");

WriteLiteral(" class=\"easyui-linkbutton\"");

WriteLiteral(" data-options=\"plain:true,iconCls:\'fa fa-plus\'\"");

WriteLiteral(" onclick=\"FeeFactAdd()\"");

WriteLiteral(">新增</a>\r\n            <a");

WriteLiteral(" class=\"easyui-linkbutton\"");

WriteLiteral(" data-options=\"plain:true,iconCls:\'fa fa-minus-circle\'\"");

WriteLiteral(" onclick=\"FeeFactDel()\"");

WriteLiteral(">删除</a>\r\n        </span>\r\n        <script");

WriteLiteral(" type=\"text/javascript\"");

WriteLiteral(@">
            $(function () {
                $(""#FeeFactGrid"").datagrid({
                    idField: 'Id',//主键的字段
                    singleSelect: false,
                    pagination: false,
                    //JQCustomSearch: [  //自定义搜索的字段
                    //{ value: 'DepartmentName', key: '人员部门', type: 'string' }//type支持三种类型string,datetime,combox,默认为string,combox必须提供engname
                    //],
                    //JQExcludeCol: [1, 4, 10],//导出execl排除的列
                    //JQMergeCells: { fields: ['DepartmentName', 'EmpName', 'EmpLogin'], Only: 'DepartmentName' },//当字段值相同时会自动的跨行(只对相邻有效)
                    //JQEnableFilter: true,//是否启用表格字段检索，只支持当页数据
                    url: '");

            
            #line 141 "..\..\Views\BussContractOther\infoAddConOtherFee.cshtml"
                     Write(Url.Action("jsonOtherFee", "BussContractOtherFeeFact", new { @area = "Bussiness" }));

            
            #line default
            #line hidden
WriteLiteral("\',//请求的地址\r\n                    queryParams: {ConOtherID:");

            
            #line 142 "..\..\Views\BussContractOther\infoAddConOtherFee.cshtml"
                                        Write(Model.Id);

            
            #line default
            #line hidden
WriteLiteral("},\r\n                    //checkOnSelect: true,//是否包含check\r\n                    to" +
"olbar: \'#FeeFactGridPanel\',//工具栏的容器ID\r\n                    columns: [[\r\n        " +
"                { field: \'ck\', align: \'center\', checkbox: true, JQIsExclude: tru" +
"e },\r\n                        { title: \'实际收款日期\', field: \'FeerDate\', width: \"15%\"" +
", align: \'center\',formatter: JQ.tools.DateTimeFormatterByT,\r\n                   " +
"         editor: {\r\n                                type: \'datebox\',\r\n          " +
"                      options: { validType: { date: \'yyyy-MM-dd\' },required: tru" +
"e } }\r\n                        },\r\n                        { title: \'金额(元)\', fie" +
"ld: \'FeeMoney\', width:  \"15%\", align: \'right\',editor:{type:\'numberspinner\',optio" +
"ns: {  precision: 2, prefix: \'￥\', required: true }}},\r\n                        {" +
" title: \'收款说明\', field: \'FeeNote\', width:  \"25%\", align: \'center\', sortable: fals" +
"e, editor: { type: \'textbox\', options: { validType: length[0, 23] } }  },\r\n     " +
"               { title: \'经办人\', field: \'CreatorEmpName\', width:  \"15%\", align: \'c" +
"enter\', sortable: false,JQIsExclude: true },\r\n                          { title:" +
" \'操作\', field: \'Id\', width:  \"15%\", align: \'center\', sortable: false,JQIsExclude:" +
" true,formatter: function (value, row, index) {\r\n                              i" +
"f (IsEdit) {\r\n                                  if (editIndex==-1) {\r\n          " +
"                            //新增一行\r\n                                      return" +
" \"<a href=\\\"#\\\" class=\\\"easyui-linkbutton\\\"  style=\\\"line-height:22px;\\\" onclick" +
"=\\\"endEditing(this)\\\">创建</>\";\r\n                                  }else {\r\n      " +
"                                return \"<a href=\\\"#\\\" class=\\\"easyui-linkbutton\\" +
"\"  style=\\\"line-height:22px;\\\" onclick=\\\"endEditing(this)\\\">更新</>&nbsp;&nbsp;&nb" +
"sp;<a href=\\\"#\\\" class=\\\"easyui-linkbutton\\\"  style=\\\"line-height:22px;padding-m" +
"argin:10px\\\" onclick=\\\"CannelRow()\\\">取消</>\";\r\n                                  " +
"}\r\n\r\n                              }\r\n                              else  {\r\n   " +
"                               return \"<a href=\\\"#\\\" class=\\\"easyui-linkbutton\\\"" +
"  style=\\\"line-height:22px;\\\" onclick=\\\"onDblClickRow(\"+index+\")\\\">编辑</>\";\r\n    " +
"                          }\r\n                          }\r\n                      " +
"    },\r\n                    ]],\r\n                    onDblClickRow: onDblClickRo" +
"w,\r\n                });\r\n            })\r\n\r\n            var IsEdit=false;//是否在编辑状" +
"态(true编辑、false列表)\r\n            var editIndex=-1;//编辑行号\r\n            //新增行\r\n     " +
"       function FeeFactAdd() {\r\n                if (IsEdit==false) {\r\n          " +
"          IsEdit=true;\r\n                    //var _rowC=$(\'#planTable\').datagrid" +
"(\'getRows\').length==undefined?0:$(\'#planTable\').datagrid(\'getRows\').length;\r\n   " +
"                 editIndex=-1;\r\n                    $(\'#FeeFactGrid\').datagrid(\'" +
"appendRow\', {});\r\n                    editIndex = $(\'#FeeFactGrid\').datagrid(\'ge" +
"tRows\').length - 1;\r\n                    $(\'#FeeFactGrid\').datagrid(\'beginEdit\'," +
" editIndex);\r\n                }\r\n            }\r\n            //编辑\r\n            fu" +
"nction onDblClickRow(index) {\r\n                if (!IsEdit) {\r\n                 " +
"   //编辑行\r\n                    IsEdit=true;\r\n                    editIndex = inde" +
"x;\r\n                    $(\'#FeeFactGrid\').datagrid(\'refreshRow\', index);//刷新行\r\n " +
"                   $(\'#FeeFactGrid\').datagrid(\'beginEdit\', index);\r\n            " +
"        //combox参数重新赋值\r\n                    //reloadCombox(editIndex);\r\n\r\n      " +
"          } else {\r\n                    alert(\"第\"+(parseInt(editIndex)+1)+\"行正在编辑" +
"\");\r\n                    //取消编辑行\r\n                    //$(\'#planTable\').datagrid" +
"(\'selectRow\', editIndex);\r\n                }\r\n            }\r\n            //创建、更新" +
"\r\n            function endEditing(objEvent) {\r\n                if (IsEdit) {\r\n  " +
"                  //编辑状态、验证下\r\n                    if ($(\'#FeeFactGrid\').datagrid" +
"(\'validateRow\', editIndex)) {\r\n                        //提交数据\r\n                 " +
"       var ed = $(\'#FeeFactGrid\').datagrid(\'getEditors\', editIndex);\r\n          " +
"              var productname = $(ed[0].target).combobox(\'getText\');\r\n          " +
"              //var _id=$(ed[0].target).combobox(\'getValue\');\r\n                 " +
"       //combox赋值\r\n                        //$(\'#FeeFactGrid\').datagrid(\'getRows" +
"\')[editIndex][\'text\'] = productname;\r\n                        //$(\'#FeeFactGrid\'" +
").datagrid(\'getRows\')[editIndex][\'ProjId\'] = _id;\r\n                        //che" +
"ckbox赋值\r\n                        //var CheckB = $(ed[4].target);\r\n              " +
"          IsEdit=false;\r\n                        //$(\'#FeeFactGrid\').datagrid(\'g" +
"etRows\')[editIndex][\'FinishedCheck\']=($(CheckB).is(\":checked\")?\"1\":\"0\");\r\n      " +
"                  $(\'#FeeFactGrid\').datagrid(\'endEdit\', editIndex);\r\n\r\n         " +
"               var _postDate=$(\'#FeeFactGrid\').datagrid(\'getRows\')[editIndex];\r\n" +
"                        _postDate.RefID=");

            
            #line 224 "..\..\Views\BussContractOther\infoAddConOtherFee.cshtml"
                                   Write(Model.Id);

            
            #line default
            #line hidden
WriteLiteral(";\r\n                        $.post(\'");

            
            #line 225 "..\..\Views\BussContractOther\infoAddConOtherFee.cshtml"
                           Write(Url.Action("save", "BussContractOtherFeeFact"));

            
            #line default
            #line hidden
WriteLiteral("?Id=\'+(_postDate.hasOwnProperty(\"Id\")?_postDate.Id:0),_postDate,function () {\r\n  " +
"                          JQ.dialog.show(\"操作成功！\");\r\n                            " +
"$(\'#FeeFactGrid\').datagrid(\'reload\');\r\n                            //$(\'#FeeFact" +
"Grid\').datagrid(\'refreshRow\', editIndex);//刷新行\r\n                            //ed" +
"itIndex=-1;\r\n\r\n                            //FeeFactAdd();\r\n                    " +
"    }).error(function (a) {\r\n                            var CurrentIndex=editIn" +
"dex;\r\n                            editIndex=_postDate.hasOwnProperty(\"Id\")?editI" +
"ndex:-1;\r\n                            IsEdit=true;\r\n                            " +
"$(\'#FeeFactGrid\').datagrid(\'refreshRow\', CurrentIndex);//刷新行\r\n                  " +
"          $(\'#FeeFactGrid\').datagrid(\'beginEdit\', CurrentIndex);\r\n              " +
"              editIndex=CurrentIndex;\r\n                            alert(a.respo" +
"nseText);\r\n                        });\r\n                        //JQ.datagrid.au" +
"toRefdatagrid();\r\n                    } else {\r\n                        return f" +
"alse;\r\n                    }\r\n                }\r\n            }\r\n            //行取" +
"消\r\n            function CannelRow() {\r\n                IsEdit=false;\r\n          " +
"      $(\'#FeeFactGrid\') .datagrid(\'cancelEdit\', editIndex);\r\n                edi" +
"tIndex=-1;\r\n            }\r\n            //删除行\r\n            function FeeFactDel() " +
"{\r\n                var row = $(\'#FeeFactGrid\').datagrid(\'getSelections\');\r\n     " +
"           if (row.length==0) {\r\n                    JQ.dialog.warning(\"请至少选择一项！" +
"！！\");\r\n                    return;\r\n                }\r\n                if (!conf" +
"irm(\"你确定要删除吗?\")) {\r\n                    return;\r\n                }\r\n\r\n          " +
"      var DelIds=[];\r\n                var KeyID=\"\";\r\n                var _Curren" +
"tEditRow=$(\"#FeeFactGrid\").datagrid(\"getRows\")[editIndex];\r\n                for " +
"(var i = 0; i < row.length; i++) {\r\n                    var _rowindex=$(\'#FeeFac" +
"tGrid\').datagrid(\'getRowIndex\',row[i]);\r\n\r\n                    if (IsEdit) {\r\n  " +
"                      if (_rowindex==editIndex) {\r\n                            /" +
"/先处理编辑行\r\n                            IsEdit=false;\r\n                        }\r\n " +
"                   }\r\n                    var _dataROW=row[i];\r\n                " +
"    if (_dataROW.hasOwnProperty(\"Id\")) {\r\n                        KeyID+=(_dataR" +
"OW.Id+\",\");\r\n                    }\r\n                    DelIds.push(_rowindex);\r" +
"\n                }\r\n\r\n                $.post(\'");

            
            #line 283 "..\..\Views\BussContractOther\infoAddConOtherFee.cshtml"
                   Write(Url.Action("delOtherFeeByIDs", "BussContractOtherFeeFact"));

            
            #line default
            #line hidden
WriteLiteral(@"',{ids:KeyID},function () {
                    DelIds.reverse();//倒序排列
                    for (var i = 0; i < DelIds.length; i++) {
                        $('#FeeFactGrid').datagrid('deleteRow',DelIds[i]);
                    }
                    if (IsEdit) {
                        //存在行编辑、重新赋值行号
                        editIndex=$('#FeeFactGrid').datagrid('getRowIndex',_CurrentEditRow);
                    }
                    JQ.dialog.show(""删除成功！"");
                    //JQ.datagrid.autoRefdatagrid();
                }).error(function (err) {
                    alert(""删除失败！"");
                });
            }
        </script>
    </div>
");

            
            #line 300 "..\..\Views\BussContractOther\infoAddConOtherFee.cshtml"




            
            #line default
            #line hidden
WriteLiteral("    <div");

WriteLiteral(" style=\"padding-top:10px\"");

WriteLiteral("> </div>\r\n");

WriteLiteral("    <table");

WriteLiteral(" id=\"InvoiceGrid\"");

WriteLiteral("></table>\r\n");

WriteLiteral("    <div");

WriteLiteral(" id=\"InvoiceGridPanel\"");

WriteLiteral(" jqpanel=\"searchPanel\"");

WriteLiteral(" style=\"padding:5px;height:auto;\"");

WriteLiteral(">\r\n        <span");

WriteLiteral(" jqpanel=\"toolbarPanel\"");

WriteLiteral(">\r\n            <span");

WriteLiteral(" class=\"label label-default\"");

WriteLiteral("><strong");

WriteLiteral(" style=\"padding:10px;\"");

WriteLiteral(">合同开票</strong></span>\r\n            <span");

WriteLiteral(" class=\'datagrid-btn-separator\'");

WriteLiteral(" style=\'vertical-align: middle; height: 22px;display:inline-block;float:none\'");

WriteLiteral("></span>\r\n            <a");

WriteLiteral(" class=\"easyui-linkbutton\"");

WriteLiteral(" data-options=\"plain:true,iconCls:\'fa fa-plus\'\"");

WriteLiteral(" onclick=\"InvoiceAdd()\"");

WriteLiteral(">新增</a>\r\n            <a");

WriteLiteral(" class=\"easyui-linkbutton\"");

WriteLiteral(" data-options=\"plain:true,iconCls:\'fa fa-minus-circle\'\"");

WriteLiteral(" onclick=\"InvoiceDel()\"");

WriteLiteral(">删除</a>\r\n        </span>\r\n        <script");

WriteLiteral(" type=\"text/javascript\"");

WriteLiteral(">\r\n            $(function () {\r\n                $(\"#InvoiceGrid\").datagrid({\r\n   " +
"                 idField: \'Id\',//主键的字段\r\n                    singleSelect: false," +
"\r\n                    pagination: false,\r\n                    url: \'");

            
            #line 318 "..\..\Views\BussContractOther\infoAddConOtherFee.cshtml"
                     Write(Url.Action("jsonOtherInvoice", "BussContractOtherInvoice", new { @area = "Bussiness" }));

            
            #line default
            #line hidden
WriteLiteral("\',//请求的地址\r\n                    queryParams: { ConOtherID:");

            
            #line 319 "..\..\Views\BussContractOther\infoAddConOtherFee.cshtml"
                                         Write(Model.Id);

            
            #line default
            #line hidden
WriteLiteral("},\r\n                    checkOnSelect: true,//是否包含check\r\n                    tool" +
"bar: \'#InvoiceGridPanel\',//工具栏的容器ID\r\n                    columns: [[\r\n          " +
"              { field: \'ck\', align: \'center\', checkbox: true, JQIsExclude: true " +
"},\r\n\r\n                        {\r\n                            title: \'开票日期\', fiel" +
"d: \'InvoiceDate\', width: \"15%\", align: \'center\', formatter: JQ.tools.DateTimeFor" +
"matterByT,\r\n                            editor: {\r\n                             " +
"   type: \'datebox\',\r\n                                options: { validType: { dat" +
"e: \'yyyy-MM-dd\' }, required: true }\r\n                            }\r\n            " +
"            },\r\n                        { title: \'金额(元)\', field: \'InvoiceMoney\'," +
" width: \"15%\", align: \'right\', editor: { type: \'numberspinner\', options: { preci" +
"sion: 2, prefix: \'￥\', required: true } } },\r\n                        { title: \'开" +
"票说明\', field: \'InvoiceNote\', width: \"25%\", align: \'center\', sortable: false, edit" +
"or: { type: \'textbox\', options: { validType: length[0, 23] } } },\r\n             " +
"           { title: \'经办人\', field: \'CreatorEmpName\', width: \"15%\", align: \'center" +
"\', sortable: false, JQIsExclude: true },\r\n                        {\r\n           " +
"                 title: \'操作\', field: \'Id\', width: \"15%\", align: \'center\', sortab" +
"le: false, JQIsExclude: true, formatter: function (value, row, index) {\r\n       " +
"                         if (InvoiceIsEdit) {\r\n                                 " +
"   if (InvoiceeditIndex == -1) {\r\n                                        //新增一行" +
"\r\n                                        return \"<a href=\\\"#\\\" class=\\\"easyui-l" +
"inkbutton\\\"  style=\\\"line-height:22px;\\\" onclick=\\\"endInvoiceEditing()\\\">创建</>\";" +
"\r\n                                    } else {\r\n                                " +
"        return \"<a href=\\\"#\\\" class=\\\"easyui-linkbutton\\\"  style=\\\"line-height:2" +
"2px;\\\" onclick=\\\"endInvoiceEditing()\\\">更新</>&nbsp;&nbsp;&nbsp;<a href=\\\"#\\\" clas" +
"s=\\\"easyui-linkbutton\\\"  style=\\\"line-height:22px;padding-margin:10px\\\" onclick=" +
"\\\"CannelInvoiceRow()\\\">取消</>\";\r\n                                    }\r\n\r\n       " +
"                         }\r\n                                else {\r\n            " +
"                        return \"<a href=\\\"#\\\" class=\\\"easyui-linkbutton\\\"  style" +
"=\\\"line-height:22px;\\\" onclick=\\\"onInvoicetDblClickRow(\" + index + \")\\\">编辑</>\";\r" +
"\n                                }\r\n                            }\r\n\r\n           " +
"             },\r\n                    ]],\r\n                    onDblClickRow: onI" +
"nvoicetDblClickRow,\r\n\r\n                });\r\n            })\r\n\r\n            var In" +
"voiceIsEdit=false;//是否在编辑状态(true编辑、false列表)\r\n            var InvoiceeditIndex=-1" +
";//编辑行号\r\n            //新增行\r\n            function InvoiceAdd() {\r\n               " +
" if (InvoiceIsEdit==false) {\r\n                    InvoiceIsEdit=true;\r\n         " +
"           //var _rowC=$(\'#planTable\').datagrid(\'getRows\').length==undefined?0:$" +
"(\'#planTable\').datagrid(\'getRows\').length;\r\n                    InvoiceeditIndex" +
"=-1;\r\n                    $(\'#InvoiceGrid\').datagrid(\'appendRow\', {});\r\n        " +
"            InvoiceeditIndex = $(\'#InvoiceGrid\').datagrid(\'getRows\').length - 1;" +
"\r\n                    $(\'#InvoiceGrid\').datagrid(\'beginEdit\', InvoiceeditIndex);" +
"\r\n\r\n                }\r\n            }\r\n\r\n            //编辑\r\n            function o" +
"nInvoicetDblClickRow(index) {\r\n                if (!InvoiceIsEdit) {\r\n          " +
"          //编辑行\r\n                    InvoiceIsEdit=true;\r\n                    In" +
"voiceeditIndex = index;\r\n                    $(\'#InvoiceGrid\').datagrid(\'refresh" +
"Row\', InvoiceeditIndex);//刷新行\r\n                    $(\'#InvoiceGrid\').datagrid(\'b" +
"eginEdit\', InvoiceeditIndex);\r\n                    //combox参数重新赋值\r\n             " +
"       //reloadCombox(editIndex);\r\n\r\n                } else {\r\n                 " +
"   alert(\"第\"+(parseInt(InvoiceeditIndex)+1)+\"行正在编辑\");\r\n                    //取消编" +
"辑行\r\n                    //$(\'#planTable\').datagrid(\'selectRow\', editIndex);\r\n   " +
"             }\r\n            }\r\n\r\n            //创建、更新\r\n            function endIn" +
"voiceEditing() {\r\n                if (InvoiceIsEdit) {\r\n                    //编辑" +
"状态、验证下\r\n                    if ($(\'#InvoiceGrid\').datagrid(\'validateRow\', Invoic" +
"eeditIndex)) {\r\n                        //提交数据\r\n                        var ed =" +
" $(\'#InvoiceGrid\').datagrid(\'getEditors\', InvoiceeditIndex);\r\n                  " +
"      var productname = $(ed[0].target).combobox(\'getText\');\r\n                  " +
"      var _id=$( ed[0].target).combobox(\'getValue\');\r\n                        //" +
"combox赋值\r\n                        $(\'#InvoiceGrid\').datagrid(\'getRows\')[Invoicee" +
"ditIndex][\'text\'] = productname;\r\n                        $(\'#InvoiceGrid\').data" +
"grid(\'getRows\')[InvoiceeditIndex][\'ProjId\'] = _id;\r\n                        Invo" +
"iceIsEdit=false;\r\n                        $(\'#InvoiceGrid\').datagrid(\'endEdit\', " +
"InvoiceeditIndex);\r\n\r\n                        var _postDate=$(\'#InvoiceGrid\').da" +
"tagrid(\'getRows\')[InvoiceeditIndex];\r\n\r\n                        _postDate.RefID=" +
"");

            
            #line 408 "..\..\Views\BussContractOther\infoAddConOtherFee.cshtml"
                                   Write(Model.Id);

            
            #line default
            #line hidden
WriteLiteral(";\r\n                        $.post(\'");

            
            #line 409 "..\..\Views\BussContractOther\infoAddConOtherFee.cshtml"
                           Write(Url.Action("save", "BussContractOtherInvoice"));

            
            #line default
            #line hidden
WriteLiteral("?Id=\'+(_postDate.hasOwnProperty(\"Id\")?_postDate.Id:0),_postDate,function () {\r\n  " +
"                          JQ.dialog.show(\"操作成功！\");\r\n                            " +
"$(\'#InvoiceGrid\').datagrid(\'reload\');\r\n                            //$(\'#Invoice" +
"Grid\').datagrid(\'refreshRow\', InvoiceeditIndex);//刷新行\r\n                         " +
"   //InvoiceeditIndex=-1;\r\n\r\n                            //PlanAdd();\r\n         " +
"               }).error(function (a) {\r\n                            var CurrentI" +
"ndex=InvoiceeditIndex;\r\n                            InvoiceeditIndex=_postDate.h" +
"asOwnProperty(\"Id\")?InvoiceeditIndex:-1;\r\n                            InvoiceIsE" +
"dit=true;\r\n                            $(\'#InvoiceGrid\').datagrid(\'refreshRow\', " +
"CurrentIndex);//刷新行\r\n                            $(\'#InvoiceGrid\').datagrid(\'beg" +
"inEdit\', CurrentIndex);\r\n                            InvoiceeditIndex=CurrentInd" +
"ex;\r\n                            alert(a.responseText);\r\n                       " +
" });\r\n                        //JQ.datagrid.autoRefdatagrid();\r\n                " +
"    } else {\r\n\r\n                        return false;\r\n                    }\r\n  " +
"              }\r\n            }\r\n            //行取消\r\n            function CannelIn" +
"voiceRow() {\r\n                InvoiceIsEdit=false;\r\n                $(\'#InvoiceG" +
"rid\') .datagrid(\'cancelEdit\', InvoiceeditIndex);\r\n                InvoiceeditInd" +
"ex=-1;\r\n            }\r\n            //删除行\r\n            function InvoiceDel() {\r\n " +
"               var row = $(\'#InvoiceGrid\').datagrid(\'getSelections\');\r\n         " +
"       if (row.length==0) {\r\n                    JQ.dialog.warning(\"请至少选择一项！！！\")" +
";\r\n                    return;\r\n                }\r\n                if (!confirm(" +
"\"你确定要删除吗?\")) {\r\n                    return;\r\n                }\r\n                " +
"var DelIds=[];\r\n                var KeyID=\"\";\r\n                var _CurrentEditR" +
"ow=$(\"#InvoiceGrid\").datagrid(\"getRows\")[InvoiceeditIndex];\r\n                for" +
" (var i = 0; i < row.length; i++) {\r\n                    var _rowindex=$(\'#Invoi" +
"ceGrid\').datagrid(\'getRowIndex\',row[i]);\r\n\r\n                    if (InvoiceIsEdi" +
"t) {\r\n                        if (_rowindex==InvoiceeditIndex) {\r\n              " +
"              //先处理编辑行\r\n                            InvoiceIsEdit=false;\r\n      " +
"                  }\r\n                    }\r\n                    var _dataROW=row" +
"[i];\r\n                    if (_dataROW.hasOwnProperty(\"Id\")) {\r\n                " +
"        KeyID+=(_dataROW.Id+\",\");\r\n                    }\r\n                    De" +
"lIds.push(_rowindex);\r\n                }\r\n\r\n                $.post(\'");

            
            #line 467 "..\..\Views\BussContractOther\infoAddConOtherFee.cshtml"
                   Write(Url.Action("delOtherInvoiceIDs", "BussContractOtherInvoice"));

            
            #line default
            #line hidden
WriteLiteral(@"',{ids:KeyID},function () {
                    DelIds.reverse();//倒序排列
                    for (var i = 0; i < DelIds.length; i++) {
                        $('#InvoiceGrid').datagrid('deleteRow',DelIds[i]);
                    }
                    if (InvoiceIsEdit) {
                        //存在行编辑、重新赋值行号
                        InvoiceeditIndex=$('#InvoiceGrid').datagrid('getRowIndex',_CurrentEditRow);
                    }
                    JQ.dialog.show(""删除成功！"");
                    //JQ.datagrid.autoRefdatagrid();
                }).error(function (err) {
                    //alert(err.responseText);
                    alert(""删除失败！"");
                });

            }
        </script>
    </div>
");

            
            #line 486 "..\..\Views\BussContractOther\infoAddConOtherFee.cshtml"
}

            
            #line default
            #line hidden
        }
    }
}
#pragma warning restore 1591
