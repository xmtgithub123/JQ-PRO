#pragma warning disable 1591
//------------------------------------------------------------------------------
// <auto-generated>
//     此代码由工具生成。
//     运行时版本:4.0.30319.42000
//
//     对此文件的更改可能会导致不正确的行为，并且如果
//     重新生成代码，这些更改将会丢失。
// </auto-generated>
//------------------------------------------------------------------------------

namespace ASP
{
    using System;
    using System.Collections.Generic;
    using System.IO;
    using System.Linq;
    using System.Net;
    using System.Text;
    using System.Web;
    using System.Web.Helpers;
    using System.Web.Mvc;
    using System.Web.Mvc.Ajax;
    using System.Web.Mvc.Html;
    using System.Web.Routing;
    using System.Web.Security;
    using System.Web.UI;
    using System.Web.WebPages;
    
    #line 1 "..\..\Views\BussContract\FeeDetails.cshtml"
    using JQ.Web;
    
    #line default
    #line hidden
    
    [System.CodeDom.Compiler.GeneratedCodeAttribute("RazorGenerator", "2.0.0.0")]
    [System.Web.WebPages.PageVirtualPathAttribute("~/Views/BussContract/FeeDetails.cshtml")]
    public partial class _Views_BussContract_FeeDetails_cshtml : System.Web.Mvc.WebViewPage<DataModel.Models.BussContract>
    {
        public _Views_BussContract_FeeDetails_cshtml()
        {
        }
        public override void Execute()
        {
WriteLiteral("<script");

WriteLiteral(" type=\"text/javascript\"");

WriteLiteral(@">
    $(function () {
        showContract();
        JQ.form.submitInit({
            formid: 'BussContractForm',//formid提交需要用到
            buttonTypes: [],//默认按钮
            succesCollBack: function (data) {//成功回调函数,data为服务器返回值
                JQ.datagrid.autoRefdatagrid();//刷新上一级数据表格，必须在close窗体前调用
                JQ.dialog.dialogClose();//关闭窗体放在最后一步执行，以避免找不到事件源
            }
        });
    });

    function PostContract(act) {
        $.post(""");

            
            #line 18 "..\..\Views\BussContract\FeeDetails.cshtml"
           Write(Url.Action("ChangeFeeStatus"));

            
            #line default
            #line hidden
WriteLiteral("\",{ConID:");

            
            #line 18 "..\..\Views\BussContract\FeeDetails.cshtml"
                                                  Write(Model.Id);

            
            #line default
            #line hidden
WriteLiteral(@",ActType:act},function (result) {
            JQ.dialog.show(result.stateMsg);
            $(""#ConIsFeeFinished"").val(act);
            showContract();
            //JQ.datagrid.autoRefdatagrid();
        }).error(function (err,r) {
            alert(r.responseText);
        })
    }
    function  showContract() {
        //alert($(""#ConIsFeeFinished"").val());
        if ($(""#ConIsFeeFinished"").val()==""True"") {
            $(""#times"").show();
            $(""#check"").hide();
        }
        else {
            $(""#times"").hide();
            $(""#check"").show();
        }
    }

    $.extend($.fn.datagrid.defaults.view,{
        onAfterRender:function(target){
            if (target.id==""PlanGrid"") {
                if ($(target).datagrid(""getRows"").length==0) {
                    PlanAdd();
                }
            }
            else if (target.id==""FeeGrid"") {
                if ($(target).datagrid(""getRows"").length==0) {
                    FactAdd();
                }
            }
            else if (target.id==""InvoiceGrid"") {
                if ($(target).datagrid(""getRows"").length==0) {
                    InvoiceAdd();
                }
            }
        }
    });
</script>
");

            
            #line 59 "..\..\Views\BussContract\FeeDetails.cshtml"
Write(Html.Hidden("ConIsFeeFinished"));

            
            #line default
            #line hidden
WriteLiteral("\r\n<div");

WriteLiteral(" JQPanel=\'dialogButtonPanel\'");

WriteLiteral(">\r\n    <a");

WriteLiteral(" class=\"easyui-linkbutton\"");

WriteLiteral(" id=\"times\"");

WriteLiteral(" data-options=\"plain:true,iconCls:\'fa fa-times-circle\'\"");

WriteLiteral(" onclick=\"PostContract(\'False\')\"");

WriteLiteral("><strong>置为未收清</strong></a>\r\n    <a");

WriteLiteral(" class=\"easyui-linkbutton\"");

WriteLiteral(" id=\"check\"");

WriteLiteral(" data-options=\"plain:true,iconCls:\'fa fa-check-circle\'\"");

WriteLiteral(" onclick=\"PostContract(\'True\')\"");

WriteLiteral("><strong>置为收清</strong></a>\r\n\r\n    <div>\r\n        <table");

WriteLiteral(" class=\"table table-bordered\"");

WriteLiteral(">\r\n            <tr>\r\n                <th");

WriteLiteral(" width=\"10%\"");

WriteLiteral(">合同编号</th>\r\n                <td");

WriteLiteral(" width=\"15%\"");

WriteLiteral(">\r\n");

WriteLiteral("                    ");

            
            #line 69 "..\..\Views\BussContract\FeeDetails.cshtml"
               Write(Model.ConNumber);

            
            #line default
            #line hidden
WriteLiteral("\r\n                </td>\r\n                <th");

WriteLiteral(" width=\"10%\"");

WriteLiteral(">合同名称</th>\r\n                <td>\r\n");

WriteLiteral("                    ");

            
            #line 73 "..\..\Views\BussContract\FeeDetails.cshtml"
               Write(Model.ConName);

            
            #line default
            #line hidden
WriteLiteral("\r\n                </td>\r\n                <th");

WriteLiteral(" width=\"10%\"");

WriteLiteral(">合同金额(元)</th>\r\n                <td");

WriteLiteral(" width=\"15%\"");

WriteLiteral(">\r\n");

WriteLiteral("                    ");

            
            #line 77 "..\..\Views\BussContract\FeeDetails.cshtml"
               Write(Model.ConFee);

            
            #line default
            #line hidden
WriteLiteral("\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n    ");

WriteLiteral("\r\n</div>\r\n\r\n<table");

WriteLiteral(" id=\"PlanGrid\"");

WriteLiteral("></table>\r\n<div");

WriteLiteral(" id=\"PlanGridPanel\"");

WriteLiteral(" JQPanel=\"searchPanel\"");

WriteLiteral(" style=\"padding:5px;height:auto;\"");

WriteLiteral(">\r\n    <span");

WriteLiteral(" JQPanel=\"toolbarPanel\"");

WriteLiteral(">\r\n        <span");

WriteLiteral(" class=\"label label-default\"");

WriteLiteral("><strong");

WriteLiteral(" style=\"padding:10px;\"");

WriteLiteral(">收款计划</strong></span>\r\n        <span");

WriteLiteral(" class=\'datagrid-btn-separator\'");

WriteLiteral(" style=\'vertical-align: middle; height: 22px;display:inline-block;float:none\'");

WriteLiteral("></span>\r\n        <a");

WriteLiteral(" class=\"easyui-linkbutton\"");

WriteLiteral(" data-options=\"plain:true,iconCls:\'fa fa-plus\'\"");

WriteLiteral(" onclick=\"PlanAdd()\"");

WriteLiteral(">新增</a>\r\n        <a");

WriteLiteral(" class=\"easyui-linkbutton\"");

WriteLiteral(" data-options=\"plain:true,iconCls:\'fa fa-minus-circle\'\"");

WriteLiteral(" onclick=\"PlanDel()\"");

WriteLiteral(">删除</a>\r\n    </span>\r\n    <script");

WriteLiteral(" type=\"text/javascript\"");

WriteLiteral(@">
        $(function () {

            $(""#PlanGrid"").datagrid({
                idField: 'Id',//主键的字段
                singleSelect: false,
                pagination: false,
                //JQCustomSearch: [  //自定义搜索的字段
                //{ value: 'DepartmentName', key: '人员部门', type: 'string' }//type支持三种类型string,datetime,combox,默认为string,combox必须提供engname
                //],
                //JQExcludeCol: [1, 4, 10],//导出execl排除的列
                //JQMergeCells: { fields: ['DepartmentName', 'EmpName', 'EmpLogin'], Only: 'DepartmentName' },//当字段值相同时会自动的跨行(只对相邻有效)
                //JQEnableFilter: true,//是否启用表格字段检索，只支持当页数据
                url: '");

            
            #line 106 "..\..\Views\BussContract\FeeDetails.cshtml"
                 Write(Url.Action("json", "BussFeePlan", new { @area = "Bussiness" }));

            
            #line default
            #line hidden
WriteLiteral("\',//请求的地址\r\n                queryParams: {ConID:");

            
            #line 107 "..\..\Views\BussContract\FeeDetails.cshtml"
                               Write(Model.Id);

            
            #line default
            #line hidden
WriteLiteral(@"},
                checkOnSelect: true,//是否包含check
                toolbar: '#PlanGridPanel',//工具栏的容器ID
                columns: [[
                    { field: 'ck', align: 'center', checkbox: true, JQIsExclude: true },
                    { title: '项目名称', field: 'ProjID', width: 150, align: 'center',halign:'center', sortable: true,JQIsExclude: true,
                        formatter: function (value, row) {
                            return row.text;
                        },
                        editor:{
                            type:""combobox"",
                            options: {
                                data: ");

            
            #line 119 "..\..\Views\BussContract\FeeDetails.cshtml"
                                 Write(Html.Raw(ViewData["Projs"]));

            
            #line default
            #line hidden
WriteLiteral(",\r\n                                valueField: \'ProjID\',\r\n                       " +
"         textField: \'text\',\r\n                                editable: false,\r\n " +
"                               required: true,\r\n                                " +
"panelHeight: \'auto\',\r\n                            }\r\n                        }\r\n" +
"                    },\r\n                    { title: \'计划收费日期\', field: \'FeeDate\'," +
" width: 120, align: \'center\',formatter: JQ.tools.DateTimeFormatterByT,\r\n        " +
"                editor: {\r\n                            type: \'datebox\',\r\n       " +
"                     options: { validType: [\'dateISO\'],required: true } }\r\n     " +
"               },\r\n                    { title: \'金额(元)\', field: \'FeeMoney\', widt" +
"h: 120, align: \'right\',halign:\'center\',editor:{type:\'numberspinner\',options: {  " +
"precision: 2, prefix: \'￥\', required: true }}},\r\n                    { title: \'说明" +
"\', field: \'FeeNote\', width: 200, align: \'center\',halign:\'center\', sortable: true" +
", editor: { type: \'textbox\', options: { validType: length[0, 23] } }  },\r\n      " +
"              { title: \'完成情况\', field: \'IsFinished\', width: 100, align: \'center\'," +
"halign:\'center\',\r\n                        formatter: function (value, row) {\r\n  " +
"                          console.log(JSON.stringify(row.IsFinished));\r\n        " +
"                    if (row.IsFinished==\"1\"||row.IsFinished) {\r\n                " +
"                return \"√\";\r\n                            }else {\r\n\r\n            " +
"                    return \"\";\r\n                            }\r\n\r\n               " +
"         },\r\n                        editor:{ type:\'checkbox\',options:{}}\r\n     " +
"               },\r\n                    { title: \'经办人\', field: \'CreatorEmpName\', " +
"width: 100, align: \'center\', sortable: true,JQIsExclude: true },\r\n              " +
"      { title: \'操作\', field: \'Id\', width: 100, align: \'center\', sortable: true,JQ" +
"IsExclude: true,formatter: function (value, row, index) {\r\n                     " +
"   if (IsEdit) {\r\n                            if (editIndex==-1) {\r\n            " +
"                    //新增一行\r\n                                return \"<a href=\\\"#\\" +
"\" class=\\\"easyui-linkbutton\\\"  style=\\\"line-height:22px;\\\" onclick=\\\"endEditing(" +
"this)\\\">创建</>\";\r\n                            }else {\r\n                          " +
"      return \"<a href=\\\"#\\\" class=\\\"easyui-linkbutton\\\"  style=\\\"line-height:22p" +
"x;\\\" onclick=\\\"endEditing(this)\\\">更新</>&nbsp;&nbsp;&nbsp;<a href=\\\"#\\\" class=\\\"e" +
"asyui-linkbutton\\\"  style=\\\"line-height:22px;padding-margin:10px\\\" onclick=\\\"Can" +
"nelRow()\\\">取消</>\";\r\n                            }\r\n\r\n                        }\r\n" +
"                        else  {\r\n                            return \"<a href=\\\"#" +
"\\\" class=\\\"easyui-linkbutton\\\"  style=\\\"line-height:22px;\\\" onclick=\\\"onDblClick" +
"Row(\"+index+\")\\\">编辑</>\";\r\n                        }\r\n                    }\r\n\r\n  " +
"                  },\r\n                ]],\r\n                onDblClickRow: onDblC" +
"lickRow,\r\n            });\r\n        })\r\n\r\n        var IsEdit=false;//是否在编辑状态(true" +
"编辑、false列表)\r\n        var editIndex=-1;//编辑行号\r\n        //新增行\r\n        function Pl" +
"anAdd() {\r\n            if (IsEdit==false) {\r\n                IsEdit=true;\r\n     " +
"           //var _rowC=$(\'#planTable\').datagrid(\'getRows\').length==undefined?0:$" +
"(\'#planTable\').datagrid(\'getRows\').length;\r\n                editIndex=-1;\r\n     " +
"           $(\'#PlanGrid\').datagrid(\'appendRow\', {});\r\n                editIndex " +
"= $(\'#PlanGrid\').datagrid(\'getRows\').length - 1;\r\n                $(\'#PlanGrid\')" +
".datagrid(\'beginEdit\', editIndex);\r\n            }\r\n        }\r\n        //编辑\r\n    " +
"    function onDblClickRow(index) {\r\n            if (!IsEdit) {\r\n               " +
" //编辑行\r\n                IsEdit=true;\r\n                editIndex = index;\r\n      " +
"          $(\'#PlanGrid\').datagrid(\'refreshRow\', index);//刷新行\r\n                $(" +
"\'#PlanGrid\').datagrid(\'beginEdit\', index);\r\n                //当前combobox值，是否存在列表" +
"中\r\n\r\n                var _Editor=$(\'#PlanGrid\').datagrid(\'getEditors\',index)[0];" +
"\r\n                var GetVals=$(_Editor.target).combobox(\"options\").data;\r\n     " +
"           var SetVal= $(_Editor.target).combobox(\"getValue\");\r\n                " +
"var _dataVal=[];\r\n                $.each(GetVals,function (i,e) {\r\n             " +
"       _dataVal.push(e.ProjID);\r\n                })\r\n                if (_dataVa" +
"l.indexOf(SetVal)==-1) {\r\n                    $(_Editor.target).combobox(\"setVal" +
"ue\",\"0\");\r\n                }\r\n\r\n                ////当前combobox值，是否存在列表中\r\n       " +
"         var _check=$(\'#PlanGrid\').datagrid(\'getEditors\',index)[4];\r\n           " +
"     var CurrentRow=$(\'#PlanGrid\').datagrid(\'getRows\')[index];\r\n                " +
"debugger;\r\n                if (CurrentRow!=null&&_check!=null) {\r\n              " +
"      if (CurrentRow.IsFinished) {\r\n                        $(_check.target).att" +
"r(\"checked\",\"checked\");\r\n                    }else {\r\n                        $(" +
"_check.target).removeAttr(\"checked\");\r\n                    }\r\n                }\r" +
"\n\r\n            } else {\r\n                alert(\"第\"+(parseInt(editIndex)+1)+\"行正在编" +
"辑\");\r\n\r\n            }\r\n        }\r\n        //创建、更新\r\n        function endEditing(o" +
"bjEvent) {\r\n            if (IsEdit) {\r\n                //编辑状态、验证下\r\n             " +
"   if ($(\'#PlanGrid\').datagrid(\'validateRow\', editIndex)) {\r\n                   " +
" //提交数据\r\n                    var ed = $(\'#PlanGrid\').datagrid(\'getEditors\', edit" +
"Index);\r\n                    var productname = $(ed[0].target).combobox(\'getText" +
"\');\r\n                    var _id=$( ed[0].target).combobox(\'getValue\');\r\n       " +
"             //combox赋值\r\n                    $(\'#PlanGrid\').datagrid(\'getRows\')[" +
"editIndex][\'text\'] = productname;\r\n                    $(\'#PlanGrid\').datagrid(\'" +
"getRows\')[editIndex][\'ProjID\'] = _id;\r\n                    //checkbox赋值\r\n       " +
"             var CheckB = $(ed[4].target);\r\n                    IsEdit=false;\r\n " +
"                   $(\'#PlanGrid\').datagrid(\'getRows\')[editIndex][\'FinishedCheck\'" +
"]=($(CheckB).is(\":checked\")?\"1\":\"0\");\r\n                    $(\'#PlanGrid\').datagr" +
"id(\'endEdit\', editIndex);\r\n\r\n                    var _postDate=$(\'#PlanGrid\').da" +
"tagrid(\'getRows\')[editIndex];\r\n                    _postDate.ConID=");

            
            #line 240 "..\..\Views\BussContract\FeeDetails.cshtml"
                               Write(Model.Id);

            
            #line default
            #line hidden
WriteLiteral(";\r\n                    $.post(\'");

            
            #line 241 "..\..\Views\BussContract\FeeDetails.cshtml"
                       Write(Url.Action("save", "BussFeePlan"));

            
            #line default
            #line hidden
WriteLiteral("?Id=\'+(_postDate.hasOwnProperty(\"Id\")?_postDate.Id:0),_postDate,function () {\r\n  " +
"                      JQ.dialog.show(\"操作成功！\");\r\n                        $(\'#Plan" +
"Grid\').datagrid(\'reload\');\r\n                        //$(\'#PlanGrid\').datagrid(\'r" +
"efreshRow\', editIndex);//刷新行\r\n                        //editIndex=-1;\r\n\r\n       " +
"                 //PlanAdd();\r\n                    }).error(function (a) {\r\n    " +
"                    var CurrentIndex=editIndex;\r\n                        editInd" +
"ex=_postDate.hasOwnProperty(\"Id\")?editIndex:-1;\r\n                        IsEdit=" +
"true;\r\n                        $(\'#PlanGrid\').datagrid(\'refreshRow\', CurrentInde" +
"x);//刷新行\r\n                        $(\'#PlanGrid\').datagrid(\'beginEdit\', CurrentIn" +
"dex);\r\n                        editIndex=CurrentIndex;\r\n                        " +
"alert(a.responseText);\r\n                    });\r\n\r\n                } else {\r\n\r\n " +
"                   return false;\r\n                }\r\n            }\r\n        }\r\n " +
"       //行取消\r\n        function CannelRow() {\r\n            IsEdit=false;\r\n       " +
"     $(\'#PlanGrid\').datagrid(\'cancelEdit\', editIndex);\r\n            editIndex=-1" +
";\r\n        }\r\n        //删除行\r\n        function PlanDel() {\r\n            var row =" +
" $(\'#PlanGrid\').datagrid(\'getSelections\');\r\n            if (row.length==0) {\r\n  " +
"              JQ.dialog.warning(\"请至少选择一项！！！\");\r\n                return;\r\n       " +
"     }\r\n            if (!confirm(\"你确定要删除吗?\")) {\r\n                return;\r\n      " +
"      }\r\n\r\n            var DelIds=[];\r\n            var KeyID=\"\";\r\n            va" +
"r _CurrentEditRow=$(\"#PlanGrid\").datagrid(\"getRows\")[editIndex];\r\n            fo" +
"r (var i = 0; i < row.length; i++) {\r\n                var _rowindex=$(\'#PlanGrid" +
"\').datagrid(\'getRowIndex\',row[i]);\r\n\r\n                if (IsEdit) {\r\n           " +
"         if (_rowindex==editIndex) {\r\n                        //先处理编辑行\r\n        " +
"                IsEdit=false;\r\n                    }\r\n                }\r\n       " +
"         var _dataROW=row[i];\r\n                if (_dataROW.hasOwnProperty(\"Id\")" +
") {\r\n                    KeyID+=(_dataROW.Id+\",\");\r\n                }\r\n         " +
"       DelIds.push(_rowindex);\r\n            }\r\n\r\n            $.post(\'");

            
            #line 300 "..\..\Views\BussContract\FeeDetails.cshtml"
               Write(Url.Action("delByIDs", "BussFeePlan"));

            
            #line default
            #line hidden
WriteLiteral(@"',{ids:KeyID},function () {
                DelIds.reverse();//倒序排列
                for (var i = 0; i < DelIds.length; i++) {
                    $('#PlanGrid').datagrid('deleteRow',DelIds[i]);
                }
                if (IsEdit) {
                    //存在行编辑、重新赋值行号
                    editIndex=$('#PlanGrid').datagrid('getRowIndex',_CurrentEditRow);
                }
                JQ.dialog.show(""删除成功！"");
            }).error(function (err) {
                //alert(err.responseText);
                alert(""删除失败！"");
            });

        }
    </script>
</div>

<div");

WriteLiteral(" style=\"padding-top:10px\"");

WriteLiteral("> </div>\r\n<table");

WriteLiteral(" id=\"FeeGrid\"");

WriteLiteral("></table>\r\n<div");

WriteLiteral(" id=\"FeeGridPanel\"");

WriteLiteral(" JQPanel=\"searchPanel\"");

WriteLiteral(" style=\"padding:5px;height:auto;\"");

WriteLiteral(">\r\n    <span");

WriteLiteral(" JQPanel=\"toolbarPanel\"");

WriteLiteral(">\r\n        ");

WriteLiteral("\r\n        <span");

WriteLiteral(" class=\"label label-default\"");

WriteLiteral("><strong");

WriteLiteral(" style=\"padding:10px;\"");

WriteLiteral(">实际收款</strong></span>\r\n        <span");

WriteLiteral(" class=\'datagrid-btn-separator\'");

WriteLiteral(" style=\'vertical-align: middle; height: 22px;display:inline-block;float:none\'");

WriteLiteral("></span>\r\n        <a");

WriteLiteral(" class=\"easyui-linkbutton\"");

WriteLiteral(" data-options=\"plain:true,iconCls:\'fa fa-plus\'\"");

WriteLiteral(" onclick=\"FactAdd()\"");

WriteLiteral(">新增</a>\r\n        <a");

WriteLiteral(" class=\"easyui-linkbutton\"");

WriteLiteral(" data-options=\"plain:true,iconCls:\'fa fa-minus-circle\'\"");

WriteLiteral(" onclick=\"FactDel()\"");

WriteLiteral(">删除</a>\r\n        <script");

WriteLiteral(" type=\"text/javascript\"");

WriteLiteral(">\r\n            $(function () {\r\n                $(\"#FeeGrid\").datagrid({\r\n       " +
"             idField: \'Id\',//主键的字段\r\n                    singleSelect: false,\r\n  " +
"                  pagination: false,\r\n                    url: \'");

            
            #line 334 "..\..\Views\BussContract\FeeDetails.cshtml"
                     Write(Url.Action("json", "BussFeeFact", new { @area = "Bussiness" }));

            
            #line default
            #line hidden
WriteLiteral("\',//请求的地址\r\n                    queryParams: {ConID:");

            
            #line 335 "..\..\Views\BussContract\FeeDetails.cshtml"
                                   Write(Model.Id);

            
            #line default
            #line hidden
WriteLiteral(@"},
                    checkOnSelect: true,//是否包含check
                    toolbar: '#FeeGridPanel',//工具栏的容器ID
                    columns: [[
                        { field: 'ck', align: 'center', checkbox: true, JQIsExclude: true },
                        { title: '项目名称', field: 'ProjID', width: 150, align: 'center', sortable: true,JQIsExclude: true,
                            formatter: function (value, row) {
                                return row.text;
                            },
                            editor:{
                                type:""combobox"",
                                options: {
                                    data: ");

            
            #line 347 "..\..\Views\BussContract\FeeDetails.cshtml"
                                     Write(Html.Raw(ViewData["Projs"]));

            
            #line default
            #line hidden
WriteLiteral(",\r\n                                    valueField: \'ProjID\',\r\n                   " +
"                 textField: \'text\',\r\n                                    editabl" +
"e: false,\r\n                                    required: true,\r\n                " +
"                    panelHeight: \'auto\',\r\n                                }\r\n   " +
"                         }\r\n                        },\r\n                        " +
"{ title: \'收款日期\', field: \'FeeDate\', width: 120, align: \'center\',formatter: JQ.too" +
"ls.DateTimeFormatterByT,\r\n                            editor: {\r\n               " +
"                 type: \'datebox\',\r\n                                options: { va" +
"lidType: [\'dateISO\'],required: true } }\r\n                        },\r\n           " +
"             { title: \'金额(元)\', field: \'FeeMoney\', width: 120, align: \'right\',edi" +
"tor:{type:\'numberspinner\',options: {  precision: 2, prefix: \'￥\', required: true " +
"}}},\r\n                        { title: \'说明\', field: \'FeeNote\', width: 200, align" +
": \'center\', sortable: true, editor: { type: \'textbox\', options: { validType: len" +
"gth[0, 23] } }  },\r\n                        { title: \'经办人\', field: \'CreatorEmpNa" +
"me\', width: 100, align: \'center\', sortable: true,JQIsExclude: true },\r\n         " +
"               { title: \'操作\', field: \'Id\', width: 100, align: \'center\', sortable" +
": true,JQIsExclude: true,formatter: function (value, row, index) {\r\n            " +
"                if (FactIsEdit) {\r\n                                if (FacteditI" +
"ndex==-1) {\r\n                                    //新增一行\r\n                       " +
"             return \"<a href=\\\"#\\\" class=\\\"easyui-linkbutton\\\"  style=\\\"line-hei" +
"ght:22px;\\\" onclick=\\\"endFactEditing()\\\">创建</>\";\r\n                              " +
"  }else {\r\n                                    return \"<a href=\\\"#\\\" class=\\\"eas" +
"yui-linkbutton\\\"  style=\\\"line-height:22px;\\\" onclick=\\\"endFactEditing()\\\">更新</>" +
"&nbsp;&nbsp;&nbsp;<a href=\\\"#\\\" class=\\\"easyui-linkbutton\\\"  style=\\\"line-height" +
":22px;padding-margin:10px\\\" onclick=\\\"CannelFactRow()\\\">取消</>\";\r\n               " +
"                 }\r\n\r\n                            }\r\n                           " +
" else  {\r\n                                return \"<a href=\\\"#\\\" class=\\\"easyui-l" +
"inkbutton\\\"  style=\\\"line-height:22px;\\\" onclick=\\\"onFactDblClickRow(\"+index+\")\\" +
"\">编辑</>\";\r\n                            }\r\n                        }\r\n\r\n         " +
"               },\r\n                    ]],\r\n                    onDblClickRow: o" +
"nFactDblClickRow,\r\n\r\n                });\r\n            })\r\n\r\n            var Fact" +
"IsEdit=false;//是否在编辑状态(true编辑、false列表)\r\n            var FacteditIndex=-1;//编辑行号\r" +
"\n            //新增行\r\n            function FactAdd() {\r\n                if (FactIs" +
"Edit==false) {\r\n                    FactIsEdit=true;\r\n                    //var " +
"_rowC=$(\'#planTable\').datagrid(\'getRows\').length==undefined?0:$(\'#planTable\').da" +
"tagrid(\'getRows\').length;\r\n                    FacteditIndex=-1;\r\n              " +
"      $(\'#FeeGrid\').datagrid(\'appendRow\', {});\r\n                    FacteditInde" +
"x = $(\'#FeeGrid\').datagrid(\'getRows\').length - 1;\r\n                    $(\'#FeeGr" +
"id\').datagrid(\'beginEdit\', FacteditIndex);\r\n\r\n                }\r\n            }\r\n" +
"\r\n            //编辑\r\n            function onFactDblClickRow(index) {\r\n           " +
"     if (!FactIsEdit) {\r\n                    //编辑行\r\n                    FactIsEd" +
"it=true;\r\n                    FacteditIndex = index;\r\n                    $(\'#Fe" +
"eGrid\').datagrid(\'refreshRow\', FacteditIndex);//刷新行\r\n                    $(\'#Fee" +
"Grid\').datagrid(\'beginEdit\', FacteditIndex);\r\n                    //combox参数重新赋值" +
"\r\n                    //reloadCombox(editIndex);\r\n                    var _Edito" +
"r=$(\'#FeeGrid\').datagrid(\'getEditors\',index)[0];\r\n                    var GetVal" +
"s=$(_Editor.target).combobox(\"options\").data;\r\n                    var SetVal= $" +
"(_Editor.target).combobox(\"getValue\");\r\n                    var _dataVal=[];\r\n  " +
"                  $.each(GetVals,function (i,e) {\r\n                        _data" +
"Val.push(e.ProjID);\r\n                    })\r\n                    if (_dataVal.in" +
"dexOf(SetVal)==-1) {\r\n                        $(_Editor.target).combobox(\"setVal" +
"ue\",\"0\");\r\n                    }\r\n\r\n                } else {\r\n                  " +
"  alert(\"第\"+(parseInt(FacteditIndex)+1)+\"行正在编辑\");\r\n                    //取消编辑行\r\n" +
"                    //$(\'#planTable\').datagrid(\'selectRow\', editIndex);\r\n       " +
"         }\r\n            }\r\n\r\n            //创建、更新\r\n            function endFactEd" +
"iting() {\r\n                if (FactIsEdit) {\r\n                    //编辑状态、验证下\r\n  " +
"                  if ($(\'#FeeGrid\').datagrid(\'validateRow\', FacteditIndex)) {\r\n " +
"                       //提交数据\r\n                        var ed = $(\'#FeeGrid\').da" +
"tagrid(\'getEditors\', FacteditIndex);\r\n                        var productname = " +
"$(ed[0].target).combobox(\'getText\');\r\n                        var _id=$( ed[0].t" +
"arget).combobox(\'getValue\');\r\n                        //combox赋值\r\n              " +
"          $(\'#FeeGrid\').datagrid(\'getRows\')[FacteditIndex][\'text\'] = productname" +
";\r\n                        $(\'#FeeGrid\').datagrid(\'getRows\')[FacteditIndex][\'Pro" +
"jID\'] = _id;\r\n                        FactIsEdit=false;\r\n                       " +
" $(\'#FeeGrid\').datagrid(\'endEdit\', FacteditIndex);\r\n\r\n                        va" +
"r _postDate=$(\'#FeeGrid\').datagrid(\'getRows\')[FacteditIndex];\r\n\r\n               " +
"         _postDate.ConID=");

            
            #line 446 "..\..\Views\BussContract\FeeDetails.cshtml"
                                   Write(Model.Id);

            
            #line default
            #line hidden
WriteLiteral(";\r\n                        $.post(\'");

            
            #line 447 "..\..\Views\BussContract\FeeDetails.cshtml"
                           Write(Url.Action("save", "BussFeeFact"));

            
            #line default
            #line hidden
WriteLiteral("?Id=\'+(_postDate.hasOwnProperty(\"Id\")?_postDate.Id:0),_postDate,function () {\r\n  " +
"                          JQ.dialog.show(\"操作成功！\");\r\n                            " +
"$(\'#FeeGrid\').datagrid(\'reload\');\r\n\r\n                            //$(\'#FeeGrid\')" +
".datagrid(\'refreshRow\', FacteditIndex);//刷新行\r\n                            //Fact" +
"editIndex=-1;\r\n\r\n                            //PlanAdd();\r\n                     " +
"   }).error(function (a) {\r\n                            var CurrentIndex=Factedi" +
"tIndex;\r\n                            FacteditIndex=_postDate.hasOwnProperty(\"Id\"" +
")?FacteditIndex:-1;\r\n                            FactIsEdit=true;\r\n             " +
"               $(\'#FeeGrid\').datagrid(\'refreshRow\', CurrentIndex);//刷新行\r\n       " +
"                     $(\'#FeeGrid\').datagrid(\'beginEdit\', CurrentIndex);\r\n       " +
"                     FacteditIndex=CurrentIndex;\r\n                            al" +
"ert(a.responseText);\r\n                        });\r\n\r\n                    } else " +
"{\r\n\r\n                        return false;\r\n                    }\r\n             " +
"   }\r\n            }\r\n            //行取消\r\n            function CannelFactRow() {\r\n" +
"                FactIsEdit=false;\r\n                $(\'#FeeGrid\').datagrid(\'cance" +
"lEdit\', FacteditIndex);\r\n                FacteditIndex=-1;\r\n            }\r\n     " +
"       //删除行\r\n            function FactDel() {\r\n                var row = $(\'#Fe" +
"eGrid\').datagrid(\'getSelections\');\r\n                if (row.length==0) {\r\n      " +
"              JQ.dialog.warning(\"请至少选择一项！！！\");\r\n                    return;\r\n   " +
"             }\r\n                if (!confirm(\"你确定要删除吗?\")) {\r\n                   " +
" return;\r\n                }\r\n                var DelIds=[];\r\n                var" +
" KeyID=\"\";\r\n                var _CurrentEditRow=$(\"#FeeGrid\").datagrid(\"getRows\"" +
")[FacteditIndex];\r\n                for (var i = 0; i < row.length; i++) {\r\n     " +
"               var _rowindex=$(\'#FeeGrid\').datagrid(\'getRowIndex\',row[i]);\r\n\r\n  " +
"                  if (FactIsEdit) {\r\n                        if (_rowindex==Fact" +
"editIndex) {\r\n                            //先处理编辑行\r\n                            " +
"FactIsEdit=false;\r\n                        }\r\n                    }\r\n           " +
"         var _dataROW=row[i];\r\n                    if (_dataROW.hasOwnProperty(\"" +
"Id\")) {\r\n                        KeyID+=(_dataROW.Id+\",\");\r\n                    " +
"}\r\n                    DelIds.push(_rowindex);\r\n                }\r\n\r\n           " +
"     $.post(\'");

            
            #line 506 "..\..\Views\BussContract\FeeDetails.cshtml"
                   Write(Url.Action("delByIDs", "BussFeeFact"));

            
            #line default
            #line hidden
WriteLiteral(@"',{ids:KeyID},function () {
                    DelIds.reverse();//倒序排列
                    for (var i = 0; i < DelIds.length; i++) {
                        $('#FeeGrid').datagrid('deleteRow',DelIds[i]);
                    }
                    if (FactIsEdit) {
                        //存在行编辑、重新赋值行号
                        FacteditIndex=$('#FeeGrid').datagrid('getRowIndex',_CurrentEditRow);
                    }
                    JQ.dialog.show(""删除成功！"");

                }).error(function (err) {
                    //alert(err.responseText);
                    alert(""删除失败！"");
                });

            }
        </script>
    </span>
</div>
<div");

WriteLiteral(" style=\"padding-top:10px\"");

WriteLiteral("> </div>\r\n<table");

WriteLiteral(" id=\"InvoiceGrid\"");

WriteLiteral("></table>\r\n<div");

WriteLiteral(" id=\"InvoiceGridPanel\"");

WriteLiteral(" JQPanel=\"searchPanel\"");

WriteLiteral(" style=\"padding:5px;height:auto;\"");

WriteLiteral(">\r\n    <span");

WriteLiteral(" JQPanel=\"toolbarPanel\"");

WriteLiteral(">\r\n        <span");

WriteLiteral(" class=\"label label-default\"");

WriteLiteral("><strong");

WriteLiteral(" style=\"padding:10px;\"");

WriteLiteral(">合同开票</strong></span>\r\n        <span");

WriteLiteral(" class=\'datagrid-btn-separator\'");

WriteLiteral(" style=\'vertical-align: middle; height: 22px;display:inline-block;float:none\'");

WriteLiteral("></span>\r\n        <a");

WriteLiteral(" class=\"easyui-linkbutton\"");

WriteLiteral(" data-options=\"plain:true,iconCls:\'fa fa-plus\'\"");

WriteLiteral(" onclick=\"InvoiceAdd()\"");

WriteLiteral(">新增</a>\r\n        <a");

WriteLiteral(" class=\"easyui-linkbutton\"");

WriteLiteral(" data-options=\"plain:true,iconCls:\'fa fa-minus-circle\'\"");

WriteLiteral(" onclick=\"InvoiceDel()\"");

WriteLiteral(">删除</a>\r\n    </span>\r\n    <script");

WriteLiteral(" type=\"text/javascript\"");

WriteLiteral(">\r\n        $(function () {\r\n            $(\"#InvoiceGrid\").datagrid({\r\n           " +
"     idField: \'Id\',//主键的字段\r\n                singleSelect: false,\r\n              " +
"  pagination: false,\r\n                url: \'");

            
            #line 541 "..\..\Views\BussContract\FeeDetails.cshtml"
                 Write(Url.Action("json", "BussFeeInvoice", new { @area = "Bussiness" }));

            
            #line default
            #line hidden
WriteLiteral("\',//请求的地址\r\n                queryParams: {ConID:");

            
            #line 542 "..\..\Views\BussContract\FeeDetails.cshtml"
                               Write(Model.Id);

            
            #line default
            #line hidden
WriteLiteral(@",IsFlow:false},
                checkOnSelect: true,//是否包含check
                toolbar: '#InvoiceGridPanel',//工具栏的容器ID
                columns: [[
                    { field: 'ck', align: 'center', checkbox: true, JQIsExclude: true },
                    { title: '项目名称', field: 'ProjID', width: 150, align: 'center', sortable: true,JQIsExclude: true,
                        formatter: function (value, row) {
                            return row.text;
                        },
                        editor:{
                            type:""combobox"",
                            options: {
                                data: ");

            
            #line 554 "..\..\Views\BussContract\FeeDetails.cshtml"
                                 Write(Html.Raw(ViewData["Projs"]));

            
            #line default
            #line hidden
WriteLiteral(",\r\n                                valueField: \'ProjID\',\r\n                       " +
"         textField: \'text\',\r\n                                editable: false,\r\n " +
"                               required: true,\r\n                                " +
"panelHeight: \'auto\',\r\n                            }\r\n                        }\r\n" +
"                    },\r\n                    { title: \'开票日期\', field: \'InvoiceDate" +
"\', width: 120, align: \'center\',formatter: JQ.tools.DateTimeFormatterByT,\r\n      " +
"                  editor: {\r\n                            type: \'datebox\',\r\n     " +
"                       options: { validType: [\'dateISO\'],required: true, } }\r\n  " +
"                  },\r\n                    { title: \'金额(元)\', field: \'InvoiceMoney" +
"\', width: 120, align: \'right\',editor:{type:\'numberspinner\',options: {  precision" +
": 2, prefix: \'￥\', required: true }}},\r\n                    { title: \'说明\', field:" +
" \'InvoiceNote\', width: 200, align: \'center\', sortable: true, editor: { type: \'te" +
"xtbox\', options: { validType: length[0, 23] } }  },\r\n                    { title" +
": \'经办人\', field: \'CreatorEmpName\', width: 100, align: \'center\', sortable: true,JQ" +
"IsExclude: true },\r\n                    { title: \'操作\', field: \'Id\', width: 100, " +
"align: \'center\', sortable: true,JQIsExclude: true,formatter: function (value, ro" +
"w, index) {\r\n                        if (InvoiceIsEdit) {\r\n                     " +
"       if (InvoiceeditIndex==-1) {\r\n                                //新增一行\r\n    " +
"                            return \"<a href=\\\"#\\\" class=\\\"easyui-linkbutton\\\"  s" +
"tyle=\\\"line-height:22px;\\\" onclick=\\\"endInvoiceEditing()\\\">创建</>\";\r\n            " +
"                }else {\r\n                                return \"<a href=\\\"#\\\" c" +
"lass=\\\"easyui-linkbutton\\\"  style=\\\"line-height:22px;\\\" onclick=\\\"endInvoiceEdit" +
"ing()\\\">更新</>&nbsp;&nbsp;&nbsp;<a href=\\\"#\\\" class=\\\"easyui-linkbutton\\\"  style=" +
"\\\"line-height:22px;padding-margin:10px\\\" onclick=\\\"CannelInvoiceRow()\\\">取消</>\";\r" +
"\n                            }\r\n\r\n                        }\r\n                   " +
"     else  {\r\n                            return \"<a href=\\\"#\\\" class=\\\"easyui-l" +
"inkbutton\\\"  style=\\\"line-height:22px;\\\" onclick=\\\"onInvoicetDblClickRow(\"+index" +
"+\")\\\">编辑</>\";\r\n                        }\r\n                    }\r\n\r\n             " +
"       },\r\n                ]],\r\n                onDblClickRow: onInvoicetDblClic" +
"kRow,\r\n\r\n            });\r\n        })\r\n\r\n        var InvoiceIsEdit=false;//是否在编辑状" +
"态(true编辑、false列表)\r\n        var InvoiceeditIndex=-1;//编辑行号\r\n        //新增行\r\n      " +
"  function InvoiceAdd() {\r\n            if (InvoiceIsEdit==false) {\r\n            " +
"    InvoiceIsEdit=true;\r\n                //var _rowC=$(\'#planTable\').datagrid(\'g" +
"etRows\').length==undefined?0:$(\'#planTable\').datagrid(\'getRows\').length;\r\n      " +
"          InvoiceeditIndex=-1;\r\n                $(\'#InvoiceGrid\').datagrid(\'appe" +
"ndRow\', {});\r\n                InvoiceeditIndex = $(\'#InvoiceGrid\').datagrid(\'get" +
"Rows\').length - 1;\r\n                $(\'#InvoiceGrid\').datagrid(\'beginEdit\', Invo" +
"iceeditIndex);\r\n\r\n            }\r\n        }\r\n\r\n        //编辑\r\n        function onI" +
"nvoicetDblClickRow(index) {\r\n            if (!InvoiceIsEdit) {\r\n                " +
"//编辑行\r\n                InvoiceIsEdit=true;\r\n                InvoiceeditIndex = i" +
"ndex;\r\n                $(\'#InvoiceGrid\').datagrid(\'refreshRow\', InvoiceeditIndex" +
");//刷新行\r\n                $(\'#InvoiceGrid\').datagrid(\'beginEdit\', InvoiceeditInde" +
"x);\r\n                //combox参数重新赋值\r\n                //reloadCombox(editIndex);\r" +
"\n                var _Editor=$(\'#InvoiceGrid\').datagrid(\'getEditors\',index)[0];\r" +
"\n                var GetVals=$(_Editor.target).combobox(\"options\").data;\r\n      " +
"          var SetVal= $(_Editor.target).combobox(\"getValue\");\r\n                v" +
"ar _dataVal=[];\r\n                $.each(GetVals,function (i,e) {\r\n              " +
"      _dataVal.push(e.ProjID);\r\n                })\r\n                if (_dataVal" +
".indexOf(SetVal)==-1) {\r\n                    $(_Editor.target).combobox(\"setValu" +
"e\",\"0\");\r\n                }\r\n\r\n            } else {\r\n                alert(\"第\"+(" +
"parseInt(InvoiceeditIndex)+1)+\"行正在编辑\");\r\n                //取消编辑行\r\n              " +
"  //$(\'#planTable\').datagrid(\'selectRow\', editIndex);\r\n            }\r\n        }\r" +
"\n\r\n        //创建、更新\r\n        function endInvoiceEditing() {\r\n            if (Invo" +
"iceIsEdit) {\r\n                //编辑状态、验证下\r\n                if ($(\'#InvoiceGrid\')." +
"datagrid(\'validateRow\', InvoiceeditIndex)) {\r\n                    //提交数据\r\n      " +
"              var ed = $(\'#InvoiceGrid\').datagrid(\'getEditors\', InvoiceeditIndex" +
");\r\n                    var productname = $(ed[0].target).combobox(\'getText\');\r\n" +
"                    var _id=$( ed[0].target).combobox(\'getValue\');\r\n            " +
"        //combox赋值\r\n                    $(\'#InvoiceGrid\').datagrid(\'getRows\')[In" +
"voiceeditIndex][\'text\'] = productname;\r\n                    $(\'#InvoiceGrid\').da" +
"tagrid(\'getRows\')[InvoiceeditIndex][\'ProjID\'] = _id;\r\n                    Invoic" +
"eIsEdit=false;\r\n                    $(\'#InvoiceGrid\').datagrid(\'endEdit\', Invoic" +
"eeditIndex);\r\n\r\n                    var _postDate=$(\'#InvoiceGrid\').datagrid(\'ge" +
"tRows\')[InvoiceeditIndex];\r\n\r\n                    _postDate.ConID=");

            
            #line 653 "..\..\Views\BussContract\FeeDetails.cshtml"
                               Write(Model.Id);

            
            #line default
            #line hidden
WriteLiteral(";\r\n                    $.post(\'");

            
            #line 654 "..\..\Views\BussContract\FeeDetails.cshtml"
                       Write(Url.Action("save", "BussFeeInvoice"));

            
            #line default
            #line hidden
WriteLiteral("?Id=\'+(_postDate.hasOwnProperty(\"Id\")?_postDate.Id:0),_postDate,function () {\r\n  " +
"                      JQ.dialog.show(\"操作成功！\");\r\n                        $(\'#Invo" +
"iceGrid\').datagrid(\'reload\');\r\n\r\n                        //$(\'#InvoiceGrid\').dat" +
"agrid(\'refreshRow\', InvoiceeditIndex);//刷新行\r\n                        //Invoiceed" +
"itIndex=-1;\r\n\r\n                        //PlanAdd();\r\n                    }).erro" +
"r(function (a) {\r\n                        var CurrentIndex=InvoiceeditIndex;\r\n  " +
"                      InvoiceeditIndex=_postDate.hasOwnProperty(\"Id\")?Invoiceedi" +
"tIndex:-1;\r\n                        InvoiceIsEdit=true;\r\n                       " +
" $(\'#InvoiceGrid\').datagrid(\'refreshRow\', CurrentIndex);//刷新行\r\n                 " +
"       $(\'#InvoiceGrid\').datagrid(\'beginEdit\', CurrentIndex);\r\n                 " +
"       InvoiceeditIndex=CurrentIndex;\r\n                        alert(a.responseT" +
"ext);\r\n                    });\r\n\r\n                } else {\r\n\r\n                  " +
"  return false;\r\n                }\r\n            }\r\n        }\r\n        //行取消\r\n   " +
"     function CannelInvoiceRow() {\r\n            InvoiceIsEdit=false;\r\n          " +
"  $(\'#InvoiceGrid\').datagrid(\'cancelEdit\', InvoiceeditIndex);\r\n            Invoi" +
"ceeditIndex=-1;\r\n        }\r\n        //删除行\r\n        function InvoiceDel() {\r\n    " +
"        var row = $(\'#InvoiceGrid\').datagrid(\'getSelections\');\r\n            if (" +
"row.length==0) {\r\n                JQ.dialog.warning(\"请至少选择一项！！！\");\r\n            " +
"    return;\r\n            }\r\n            if (!confirm(\"你确定要删除吗?\")) {\r\n           " +
"     return;\r\n            }\r\n            var DelIds=[];\r\n            var KeyID=\"" +
"\";\r\n            var _CurrentEditRow=$(\"#InvoiceGrid\").datagrid(\"getRows\")[Invoic" +
"eeditIndex];\r\n            for (var i = 0; i < row.length; i++) {\r\n              " +
"  var _rowindex=$(\'#InvoiceGrid\').datagrid(\'getRowIndex\',row[i]);\r\n\r\n           " +
"     if (InvoiceIsEdit) {\r\n                    if (_rowindex==InvoiceeditIndex) " +
"{\r\n                        //先处理编辑行\r\n                        InvoiceIsEdit=false" +
";\r\n                    }\r\n                }\r\n                var _dataROW=row[i]" +
";\r\n                if (_dataROW.hasOwnProperty(\"Id\")) {\r\n                    Key" +
"ID+=(_dataROW.Id+\",\");\r\n                }\r\n                DelIds.push(_rowindex" +
");\r\n            }\r\n\r\n            $.post(\'");

            
            #line 713 "..\..\Views\BussContract\FeeDetails.cshtml"
               Write(Url.Action("delByIDs", "BussFeeInvoice"));

            
            #line default
            #line hidden
WriteLiteral(@"',{'ids':KeyID},function () {
                DelIds.reverse();//倒序排列
                for (var i = 0; i < DelIds.length; i++) {
                    $('#InvoiceGrid').datagrid('deleteRow',DelIds[i]);
                }
                if (InvoiceIsEdit) {
                    //存在行编辑、重新赋值行号
                    InvoiceeditIndex=$('#InvoiceGrid').datagrid('getRowIndex',_CurrentEditRow);
                }
                JQ.dialog.show(""删除成功！"");

            }).error(function (err) {
                //alert(err.responseText);
                alert(""删除失败！"");
            });

        }
    </script>
</div>








");

        }
    }
}
#pragma warning restore 1591
