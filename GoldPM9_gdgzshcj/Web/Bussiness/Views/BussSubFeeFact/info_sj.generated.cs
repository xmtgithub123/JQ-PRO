#pragma warning disable 1591
//------------------------------------------------------------------------------
// <auto-generated>
//     此代码由工具生成。
//     运行时版本:4.0.30319.42000
//
//     对此文件的更改可能会导致不正确的行为，并且如果
//     重新生成代码，这些更改将会丢失。
// </auto-generated>
//------------------------------------------------------------------------------

namespace ASP
{
    using System;
    using System.Collections.Generic;
    using System.IO;
    using System.Linq;
    using System.Net;
    using System.Text;
    using System.Web;
    using System.Web.Helpers;
    using System.Web.Mvc;
    using System.Web.Mvc.Ajax;
    using System.Web.Mvc.Html;
    using System.Web.Routing;
    using System.Web.Security;
    using System.Web.UI;
    using System.Web.WebPages;
    
    #line 3 "..\..\Views\BussSubFeeFact\info_sj.cshtml"
    using JQ.Web;
    
    #line default
    #line hidden
    
    [System.CodeDom.Compiler.GeneratedCodeAttribute("RazorGenerator", "2.0.0.0")]
    [System.Web.WebPages.PageVirtualPathAttribute("~/Views/BussSubFeeFact/info_sj.cshtml")]
    public partial class _Views_BussSubFeeFact_info_sj_cshtml : System.Web.Mvc.WebViewPage<DataModel.Models.BussSubFeeFact>
    {
        public _Views_BussSubFeeFact_info_sj_cshtml()
        {
        }
        public override void Execute()
        {
WriteLiteral("\r\n");

WriteLiteral("<script");

WriteLiteral(" type=\"text/javascript\"");

WriteLiteral(">\r\n    alert(1);\r\n    var x = 0;\r\n    var requestconsuburl = \'");

            
            #line 7 "..\..\Views\BussSubFeeFact\info_sj.cshtml"
                       Write(Url.Action("json", "BussContractSub", new { @area= "Bussiness" }));

            
            #line default
            #line hidden
WriteLiteral("\';\r\n    var requestprojsuburl = \'");

            
            #line 8 "..\..\Views\BussSubFeeFact\info_sj.cshtml"
                        Write(Url.Action("json", "ProjSub", new { @area= "Project" }));

            
            #line default
            #line hidden
WriteLiteral(@"';

    $(function () {
        JQ.form.submitInit({
            formid: 'BussSubFeeFactForm',//formid提交需要用到
            buttonTypes: ['submit', 'close'],//默认按钮
            succesCollBack: function (data) {//成功回调函数,data为服务器返回值
                JJQ.datagrid.autoRefdatagrid();//刷新上一级数据表格，必须在close窗体前调用
                JQ.dialog.dialogClose();//关闭窗体放在最后一步执行，以避免找不到事件源
            },
            beforeFormSubmit: function () {
                var xml = GoldPM.loadXml(""<Root></Root>"");
                alert(111);
                try {
                    var datas = $(""#SubFeeFactGrid"").datagrid(""getData"");
                    if (datas.total == 0) {
                        alert(""请先输外委合同信息!"");
                        return false;
                    }
                    recuriseData(datas.rows, xml.documentElement);
                    $(""#strxml"").val(xml.documentElement.outerHTML);

                }
                catch (e) {
                    alert(""请先输入正确的信息!"");
                    return false;
                }
            }
        });

        $(""#SubFeeFactGrid"").datagrid({
            idField: 'Id',//主键的字段
            singleSelect: false,
            pagination: false,
            url: '");

            
            #line 42 "..\..\Views\BussSubFeeFact\info_sj.cshtml"
             Write(Url.Action("jsonFact", "BussFeeFact", new { @area = "Bussiness" }));

            
            #line default
            #line hidden
WriteLiteral("\',//请求的地址\r\n            queryParams: { FormTableID: 0 },\r\n            rownumbers: " +
"true,\r\n            toolbar: \'#SubFeeFactPanel\',//工具栏的容器ID\r\n            columns: " +
"[[\r\n               { field: \'ck\', align: \'center\', checkbox: true, JQIsExclude: " +
"true },\r\n                {\r\n                    title: \'外委合同信息\', field: \'ConSubI" +
"d\', width: 160, align: \'center\', formatter: function (value, rowData) {\r\n       " +
"                 return \"<input type=\\\"text\\\" id=\\\"c_ConSubId\" + rowData.Id + \"\\" +
"\"     name=\\\"c_ConSubId\" + rowData.Id + \"\\\"  style=\\\"width:98%;text-align:left; " +
"\\\"  />\";\r\n                    }\r\n                },\r\n                {\r\n        " +
"            title: \'外委项目信息\', field: \'ProjSubId\', width: 160, align: \'center\', fo" +
"rmatter: function (value, rowData) {\r\n                        return \"<input typ" +
"e=\\\"text\\\" id=\\\"c_ProjSubId\" + rowData.Id + \"\\\"   name=\\\"c_ProjSubId\" + rowData." +
"Id + \"\\\"   style=\\\"width:98%;text-align:left; \\\"    />\";\r\n                    }\r" +
"\n                },\r\n                {\r\n                    title: \'外委合同金额\', fie" +
"ld: \'ConSubFee\', width: 80, align: \'right\', formatter: function (value, rowData)" +
" {\r\n                        return \"<input type=\\\"text\\\" id=\\\"c_ConSubFee\" + row" +
"Data.Id + \"\\\"    name=\\\"c_ConSubFee\" + rowData.Id + \"\\\" style=\\\"width:90%;text-a" +
"lign:right;\\\"  disabled=\\\"disabled\\\"  />\";\r\n                    }\r\n             " +
"   },\r\n                {\r\n                    title: \'已付款金额\', field: \'AlreadySum" +
"FeeMoney\', width: 80, align: \'right\', formatter: function (value, rowData) {\r\n  " +
"                      return \"<input type=\\\"text\\\" id=\\\"c_AlreadySumFeeMoney\" + " +
"rowData.Id + \"\\\"  name=\\\"c_AlreadySumFeeMoney\" + rowData.Id + \"\\\" style=\\\"width:" +
"90%;text-align:right;\\\"  disabled=\\\"disabled\\\" />\";\r\n                    }\r\n    " +
"            },\r\n                {\r\n                    title: \'本次付款金额\', field: \'" +
"SubFeeFactMoney\', width: 80, align: \'center\', formatter: function (value, rowDat" +
"a) {\r\n                        return \"<input type=\\\"text\\\" id=\\\"c_SubFeeFactMone" +
"y\" + rowData.Id + \"\\\"   name=\\\"c_SubFeeFactMoney\" + rowData.Id + \"\\\"  validType=" +
"\\\"intOrFloat\\\" style=\\\"width:90%;text-align:right;\\\"    />\";\r\n                  " +
"  }\r\n                },\r\n                {\r\n                    title: \'本次付款日期\'," +
" field: \'SubFeeFactDate\', width: 120, align: \'center\', formatter: function (valu" +
"e, rowData) {\r\n                        return \"<input type=\\\"text\\\" id=\\\"c_SubFe" +
"eFactDate\" + rowData.Id + \"\\\" name=\\\"c_SubFeeFactDate\" + rowData.Id + \"\\\" validT" +
"ype=\\\"dateISO\\\" style=\\\"width:98%;text-align:left; \\\"  />\";\r\n                   " +
" }\r\n                },\r\n               {\r\n                   title: \'累计比例\', fiel" +
"d: \'TotalRatio\', width: 80, align: \'center\', formatter: function (value, rowData" +
") {\r\n                       return \"<input type=\\\"text\\\" id=\\\"c_TotalRatio\" + ro" +
"wData.Id + \"\\\"   name=\\\"c_TotalRatio\" + rowData.Id + \"\\\" style=\\\"width:90%;text-" +
"align:right;\\\"   disabled=\\\"disabled\\\" />\";\r\n                   }\r\n             " +
"  },\r\n               {\r\n                   title: \'是否结清\', field: \'IsSettle\', wid" +
"th: 100, align: \'center\', formatter: function (value, rowData) {\r\n              " +
"         var strHtml = \"<select id=\\\"c_IsSettle\" + rowData.Id + \"\\\" class=\\\"Inpu" +
"tSelect\\\" refID=\\\"c_IsSettle\" + rowData.Id + \"\\\" style=\\\"width:90px\\\">\";\r\n      " +
"                 strHtml += \"<option selected=\\\"selected\\\" value=\\\"0\\\">未结清</opti" +
"on>\";\r\n                       strHtml += \"<option  value=\\\"1\\\">已结清</option>\";\r\n " +
"                      strHtml += \"</select>\";\r\n                       return str" +
"Html;\r\n                   }\r\n               }\r\n            ]]\r\n        });\r\n    " +
"});\r\n\r\n    function AddRow() {\r\n        x--;\r\n        ");

WriteLiteral("\r\n        var _data = { \"Id\": x, \"ConSubId\": \"0\", \"ProjSubId\": \"0\", \"ConSubFee\": " +
"\"0\", \"AlreadySumFeeMoney\": \"0\", \"SubFeeFactMoney\": \"0\", \"SubFeeFactDate\": \"\", \"T" +
"otalRatio\": \"0\", \"IsSettle\": 0 }\r\n        $(\'#SubFeeFactGrid\').datagrid(\'appendR" +
"ow\', _data);\r\n\r\n        var _consubid = \"c_ConSubId\" + x;\r\n        (function ($_" +
"consubid) {\r\n            JQ.combobox.common({\r\n                id: $_consubid,\r\n" +
"                toolbar: \'#tbConSub\',//工具栏的容器ID\r\n                url: requestcon" +
"suburl,\r\n                panelWidth: 550,\r\n                panelHeight: 320,\r\n  " +
"              valueField: \'Id\',\r\n                textField: \'ConSubName\',\r\n     " +
"           multiple: false,\r\n                pagination: true,//是否分页\r\n          " +
"      JQSearch: {\r\n                    id: \'fullNameSearchConSub\',\r\n            " +
"        prompt: \'外委合同名称\',\r\n                    $panel: $(\"#tbConSub\")//搜索的容器，可以不" +
"传\r\n                },\r\n                columns: [[\r\n                            " +
" { field: \'Id\', hidden: true },\r\n                             { title: \'外委合同编号\'," +
" field: \'ConSubNumber\', width: 120, align: \'left\', sortable: true },\r\n          " +
"                   { title: \'外委合同名称\', field: \'ConSubName\', width: 120, align: \'l" +
"eft\', sortable: true },\r\n                             { title: \'外包合同类型\', field: " +
"\'ConSubTypeName\', width: 120, align: \'left\', sortable: true },\r\n                " +
"             { title: \'外包合同类别\', field: \'ConSubCategoryName\', width: 120, align: " +
"\'left\', sortable: true },\r\n                ]],\r\n                onSelect: functi" +
"on (rowIndex, rowData) {\r\n                    var array = _consubid.split(\'c_Con" +
"SubId\');\r\n                    var y = array[1];\r\n                    $(\"#c_ConSu" +
"bFee\" + y).val(rowData.ConSubFee);\r\n                    $(\"#c_AlreadySumFeeMoney" +
"\" + y).val(rowData.AlreadySumFeeMoney);\r\n                }\r\n            });\r\n   " +
"     }(_consubid));\r\n\r\n        var _projsubid = \"c_ProjSubId\" + x;\r\n\r\n        (f" +
"unction ($_projsubid) {\r\n            JQ.combobox.common({\r\n                id: $" +
"_projsubid,\r\n                toolbar: \'#tbProjSub\',//工具栏的容器ID\r\n                u" +
"rl: requestprojsuburl,\r\n                panelWidth: 550,\r\n                panelH" +
"eight: 320,\r\n                valueField: \'Id\',\r\n                textField: \'SubN" +
"ame\',\r\n                multiple: false,\r\n                pagination: true,//是否分页" +
"\r\n                JQSearch: {\r\n                    id: \'fullNameSearchProjSub\',\r" +
"\n                    prompt: \'外委项目名称\',\r\n                    $panel: $(\"#tbProjSu" +
"b\")//搜索的容器，可以不传\r\n                },\r\n                columns: [[\r\n              " +
"               { field: \'Id\', hidden: true },\r\n                             { ti" +
"tle: \'外委项目名称\', field: \'SubName\', width: 120, align: \'left\', sortable: true },\r\n " +
"                            { title: \'项目编号\', field: \'ProjNumber\', width: 120, al" +
"ign: \'left\', sortable: true },\r\n                             { title: \'项目名称\', fi" +
"eld: \'ProjName\', width: 120, align: \'left\', sortable: true },\r\n                 " +
"            { title: \'外委性质\', field: \'SubTypeName\', width: 120, align: \'left\', so" +
"rtable: true },\r\n                ]]\r\n            });\r\n        }(_projsubid))\r\n\r\n" +
"\r\n\r\n        var _subFeeFactMoney = \"c_SubFeeFactMoney\" + x;\r\n\r\n        (function" +
" ($_subFeeFactMoney) {\r\n            $(\'#\' + $_subFeeFactMoney).textbox({\r\n      " +
"          inputEvents: $.extend({}, $.fn.textbox.defaults.inputEvents, {\r\n      " +
"              keyup: function (e) {\r\n                        var array = _subFee" +
"FactMoney.split(\'c_SubFeeFactMoney\');\r\n                        var y = array[1];" +
"\r\n                        var t1 = $(\"#c_ConSubFee\" + y).val();\r\n               " +
"         var t2 = $(\"#c_AlreadySumFeeMoney\" + y).val();\r\n                       " +
" var t3 = $(this).val();\r\n                        var s1 = (isNaN(parseFloat(t1)" +
") == false ? parseFloat(t1) : 0) + (isNaN(parseFloat(t1)) == false ? parseFloat(" +
"t1) : 0);\r\n                        var s2 = (isNaN(parseFloat(t2)) == false ? pa" +
"rseFloat(t2) : 0) + (isNaN(parseFloat(t2)) == false ? parseFloat(t2) : 0);\r\n    " +
"                    var s3 = (isNaN(parseFloat(t3)) == false ? parseFloat(t3) : " +
"0) + (isNaN(parseFloat(t3)) == false ? parseFloat(t3) : 0);\r\n                   " +
"     var s4 = 0;\r\n                        if (s1 != 0) {\r\n                      " +
"      s4 = Math.round(((s2 + s3) / s1) * 100);\r\n                            s4 =" +
" isNaN(parseFloat(s4)) == false ? parseFloat(s4) : 0\r\n                        }\r" +
"\n\r\n                        $(\"#c_TotalRatio\" + y).val(s4);\r\n                    " +
"}\r\n                })\r\n            })\r\n        }(_subFeeFactMoney))\r\n\r\n        $" +
"(\"#c_SubFeeFactDate\" + x).datebox();\r\n    }\r\n\r\n    function DeleteRow() {\r\n     " +
"   var rows = $(\'#SubFeeFactGrid\').datagrid(\"getSelections\");\r\n        var copyR" +
"ows = [];\r\n        for (var j = 0; j < rows.length; j++) {\r\n            copyRows" +
".push(rows[j]);\r\n        }\r\n        for (var i = 0; i < copyRows.length; i++) {\r" +
"\n            var index = $(\'#SubFeeFactGrid\').datagrid(\'getRowIndex\', copyRows[i" +
"]);\r\n            $(\'#SubFeeFactGrid\').datagrid(\'deleteRow\', index);\r\n        }\r\n" +
"    }\r\n\r\n    function recuriseData(data, parentNode) {\r\n        for (var i = 0; " +
"i < data.length; i++) {\r\n            alert(111);\r\n            var node = parentN" +
"ode.ownerDocument.createElement(\"Item\");\r\n            node.setAttribute(\"Id\", da" +
"ta[i].Id);\r\n            node.setAttribute(\"ConSubId\", $(\"#c_ConSubId\" + data[i]." +
"Id).combogrid(\'grid\').datagrid(\'getSelected\').Id);\r\n            node.setAttribut" +
"e(\"ProjSubId\", $(\"#c_ProjSubId\" + data[i].Id).combogrid(\'grid\').datagrid(\'getSel" +
"ected\') == null ? 0 : $(\"#c_ProjSubId\" + data[i].Id).combogrid(\'grid\').datagrid(" +
"\'getSelected\').Id);\r\n            node.setAttribute(\"ConSubFee\", $(\"#c_ConSubFee\"" +
" + data[i].Id).val());\r\n            node.setAttribute(\"AlreadySumFeeMoney\", $(\"#" +
"c_AlreadySumFeeMoney\" + data[i].Id).val());\r\n            node.setAttribute(\"SubF" +
"eeFactMoney\", $(\"#c_SubFeeFactMoney\" + data[i].Id).val());\r\n            node.set" +
"Attribute(\"SubFeeFactDate\", $(\"#c_SubFeeFactDate\" + data[i].Id).datebox(\'getValu" +
"e\'));\r\n            node.setAttribute(\"TotalRatio\", $(\"#c_TotalRatio\" + data[i].I" +
"d).val());\r\n            node.setAttribute(\"IsSettle\", $(\"#c_IsSettle\" + data[i]." +
"Id).val());\r\n            parentNode.appendChild(node);\r\n            if (data[i]." +
"children && data[i].children.length > 0) {\r\n                recuriseData(data[i]" +
".children, node);\r\n            }\r\n        }\r\n    }\r\n</script>\r\n");

            
            #line 226 "..\..\Views\BussSubFeeFact\info_sj.cshtml"
 using (Html.BeginForm("save", "BussSubFeeFact", FormMethod.Post, new { @area = "Bussiness", @id = "BussSubFeeFactForm" }))
{
    
            
            #line default
            #line hidden
            
            #line 228 "..\..\Views\BussSubFeeFact\info_sj.cshtml"
Write(Html.HiddenFor(m => m.Id));

            
            #line default
            #line hidden
            
            #line 228 "..\..\Views\BussSubFeeFact\info_sj.cshtml"
                              

            
            #line default
            #line hidden
WriteLiteral("    <input");

WriteLiteral(" type=\"hidden\"");

WriteLiteral(" id=\"CompanyType\"");

WriteLiteral(" name=\"CompanyType\"");

WriteLiteral(" value=\"SJ\"");

WriteLiteral(" />\r\n");

WriteLiteral("    <table");

WriteLiteral(" class=\"table table-bordered\"");

WriteLiteral(">\r\n        <tr>\r\n            <td");

WriteLiteral(" colspan=\"4\"");

WriteLiteral(" align=\"center\"");

WriteLiteral(" style=\"border:none;\"");

WriteLiteral(">付款合同登记</td>\r\n        </tr>\r\n        <tr>\r\n            <td");

WriteLiteral(" colspan=\"4\"");

WriteLiteral(">\r\n                <table");

WriteLiteral(" id=\"SubFeeFactGrid\"");

WriteLiteral("></table>\r\n                <div");

WriteLiteral(" id=\"SubFeeFactPanel\"");

WriteLiteral(" JQPanel=\"searchPanel\"");

WriteLiteral(" style=\"padding:5px;height:auto;\"");

WriteLiteral(">\r\n                    <span");

WriteLiteral(" JQPanel=\"toolbarPanel\"");

WriteLiteral(">\r\n                        <a");

WriteLiteral(" class=\"easyui-linkbutton\"");

WriteLiteral(" data-options=\"plain:true,iconCls:\'fa fa-plus\'\"");

WriteLiteral(" onclick=\"AddRow()\"");

WriteLiteral(">新增</a>\r\n                        <a");

WriteLiteral(" class=\"easyui-linkbutton\"");

WriteLiteral(" data-options=\"plain:true,iconCls:\'fa fa-minus-circle\'\"");

WriteLiteral(" onclick=\"DeleteRow()\"");

WriteLiteral(">删除</a>\r\n                    </span>\r\n                </div>\r\n            </td>\r\n" +
"        </tr>\r\n        <tr>\r\n            <th>\r\n                上传附件\r\n           " +
" </th>\r\n            <td");

WriteLiteral(" colspan=\"3\"");

WriteLiteral(">\r\n");

            
            #line 250 "..\..\Views\BussSubFeeFact\info_sj.cshtml"
                
            
            #line default
            #line hidden
            
            #line 250 "..\..\Views\BussSubFeeFact\info_sj.cshtml"
                  
                    var uploader = new DataModel.FileUploader();
                    uploader.RefID = Model.Id;
                    uploader.RefTable = "BussSubFeeFact";
                    uploader.Name = "UploadFile1";
                    
            
            #line default
            #line hidden
            
            #line 255 "..\..\Views\BussSubFeeFact\info_sj.cshtml"
                Write(Html.Partial("~/Areas/Core/Views/UserControl/FileUploader.cshtml", uploader));

            
            #line default
            #line hidden
            
            #line 255 "..\..\Views\BussSubFeeFact\info_sj.cshtml"
                                                                                                   
                
            
            #line default
            #line hidden
WriteLiteral("\r\n            </td>\r\n        </tr>\r\n    </table>\r\n");

WriteLiteral("    <div");

WriteLiteral(" id=\"tbConSub\"");

WriteLiteral(" style=\"padding:5px;height:auto;\"");

WriteLiteral(">\r\n        <input");

WriteLiteral(" id=\"fullNameSearchConSub\"");

WriteLiteral(" style=\"width:250px;\"");

WriteLiteral(" JQWhereOptions=\"{ Key: \'ConSubName\', \'Contract\': \'like\' }\"");

WriteLiteral(" />\r\n    </div>\r\n");

WriteLiteral("    <div");

WriteLiteral(" id=\"tbProjSub\"");

WriteLiteral(" style=\"padding:5px;height:auto;\"");

WriteLiteral(">\r\n        <input");

WriteLiteral(" id=\"fullNameSearchProjSub\"");

WriteLiteral(" style=\"width:250px;\"");

WriteLiteral(" JQWhereOptions=\"{ Key: \'ConSubName\', \'Contract\': \'like\' }\"");

WriteLiteral(" />\r\n    </div>\r\n");

            
            #line 266 "..\..\Views\BussSubFeeFact\info_sj.cshtml"


            
            #line default
            #line hidden
WriteLiteral("    <input");

WriteLiteral(" type=\"hidden\"");

WriteLiteral(" id=\"strxml\"");

WriteLiteral(" name=\"strxml\"");

WriteLiteral(" />\r\n");

            
            #line 268 "..\..\Views\BussSubFeeFact\info_sj.cshtml"
                    }

            
            #line default
            #line hidden
        }
    }
}
#pragma warning restore 1591
